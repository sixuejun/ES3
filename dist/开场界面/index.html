<head><style>html{width:100%;height:auto;margin:0;padding:0;overflow:visible;background:0 0}body{width:100%;height:auto;margin:0;padding:0;overflow-x:hidden;background:0 0}#app{width:100%;min-height:100vh;display:flex;justify-content:center;align-items:flex-start;background:0 0}</style><script type="module">import'https://testingcf.jsdelivr.net/npm/klona/+esm';var e={455(e,t){t.A=(e,t)=>{const n=e.__vccOpts||e;for(const[e,a]of t)n[e]=a;return n}}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var l=t[a]={exports:{}};return e[a](l,l.exports,n),l.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const a=Vue,o=toastr;var l=n.n(o);const c=[{id:'spring',title:'春之邂逅',description:'樱花飘落的季节，命运的相遇悄然开始...',image:'',message:'樱花飘落的季节，我在樱花树下与你相遇...'},{id:'summer',title:'夏之约定',description:'蝉鸣声中，许下永不忘记的誓言...',image:'',message:'夏日的午后，我们许下了永不忘记的约定...'},{id:'autumn',title:'秋之离别',description:'红叶纷飞，不舍的泪水模糊了视线...',image:'',message:'秋天的风带走了你，却带不走我的思念...'},{id:'winter',title:'冬之重逢',description:'白雪皑皑，终于再次见到思念的人...',image:'',message:'雪花飘落，我们终于在冬天再次相遇...'}],s=[{name:'樱井 美月',role:'女主角',desc:'温柔善良的少女，拥有感知星光的神秘能力。在一次偶然中与命运相遇，开启了一段跨越时空的旅程。',image:'',colorClass:''},{name:'星野 苍',role:'男主角',desc:'神秘的转学生，似乎隐藏着不为人知的过去。冷淡的外表下，有着温暖的内心。',image:'',colorClass:'blue'},{name:'日向 心',role:'好友',desc:'美月的青梅竹马，活泼开朗的性格总能带给周围人欢笑。暗中守护着美月。',image:'',colorClass:'orange'},{name:'月见 透',role:'神秘人物',desc:'在关键时刻出现的神秘人物，似乎知道所有事情的真相。身份成谜。',image:'',colorClass:'gray'}],r='开场界面-模型数据',i=['models/','model/',''],m=['model3.json','model.json'],u={count:20,minDuration:5,maxDuration:10,maxDelay:5};function d(){try{const e=function(){if(document.querySelector('.opening-interface')){const e=800,t=window.innerWidth,n=window.innerHeight,a=1200,o=20,l=Math.max(t-2*o,0),c=Math.max(n-2*o,0);if(l>0&&c>0){const t=l/a,n=c/e,o=e*Math.min(t,n,1);return Math.max(400,Math.min(1.1*o,2e3))}}const e=document.body,t=document.documentElement,n=document.getElementById('app'),a=[e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight,n?.scrollHeight||0,n?.offsetHeight||0],o=Math.max(...a.filter(e=>e>0));return Math.max(400,Math.min(o,2e3))}(),t=window.frameElement;t?(t.style.height=`${e}px`,console.info(`[开场界面] 调整 iframe 高度: ${e}px`)):(document.body.style.minHeight=`${e}px`,console.info(`[开场界面] 调整 body 高度: ${e}px`))}catch(e){console.warn('[开场界面] 调整高度失败:',e)}}const p={class:'icon icon-sm',viewBox:'0 0 24 24'};var v=n(455);const g={},f=(0,v.A)(g,[['render',function(e,t){return(0,a.openBlock)(),(0,a.createElementBlock)('svg',p,[...t[0]||(t[0]=[(0,a.createElementVNode)('line',{x1:'19',y1:'12',x2:'5',y2:'12'},null,-1),(0,a.createElementVNode)('polyline',{points:'12 19 5 12 12 5'},null,-1)])])}]]),h={class:'icon icon-sm',viewBox:'0 0 24 24'};const y={},k=(0,v.A)(y,[['render',function(e,t){return(0,a.openBlock)(),(0,a.createElementBlock)('svg',h,[...t[0]||(t[0]=[(0,a.createElementVNode)('polyline',{points:'20 6 9 17 4 12'},null,-1)])])}]]),b={class:'icon icon-lg',viewBox:'0 0 24 24'};const N={},V=(0,v.A)(N,[['render',function(e,t){return(0,a.openBlock)(),(0,a.createElementBlock)('svg',b,[...t[0]||(t[0]=[(0,a.createElementVNode)('polyline',{points:'15 18 9 12 15 6'},null,-1)])])}]]),E={class:'icon icon-lg',viewBox:'0 0 24 24'};const x={},B=(0,v.A)(x,[['render',function(e,t){return(0,a.openBlock)(),(0,a.createElementBlock)('svg',E,[...t[0]||(t[0]=[(0,a.createElementVNode)('polyline',{points:'9 18 15 12 9 6'},null,-1)])])}]]),w={class:'icon icon-sm',viewBox:'0 0 24 24'};const C={},M=(0,v.A)(C,[['render',function(e,t){return(0,a.openBlock)(),(0,a.createElementBlock)('svg',w,[...t[0]||(t[0]=[(0,a.createElementVNode)('line',{x1:'18',y1:'6',x2:'6',y2:'18'},null,-1),(0,a.createElementVNode)('line',{x1:'6',y1:'6',x2:'18',y2:'18'},null,-1)])])}]]);const S={class:'icon',viewBox:'0 0 24 24'};const D={},j=(0,v.A)(D,[['render',function(e,t){return(0,a.openBlock)(),(0,a.createElementBlock)('svg',S,[...t[0]||(t[0]=[(0,a.createElementVNode)('polygon',{points:'5 3 19 12 5 21 5 3'},null,-1)])])}]]),L={class:'icon',viewBox:'0 0 24 24'};const T={},U=(0,v.A)(T,[['render',function(e,t){return(0,a.openBlock)(),(0,a.createElementBlock)('svg',L,[...t[0]||(t[0]=[(0,a.createElementVNode)('circle',{cx:'12',cy:'12',r:'3'},null,-1),(0,a.createElementVNode)('path',{d:'M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z'},null,-1)])])}]]),I={class:'icon',viewBox:'0 0 24 24'};const R={},F=(0,v.A)(R,[['render',function(e,t){return(0,a.openBlock)(),(0,a.createElementBlock)('svg',I,[...t[0]||(t[0]=[(0,a.createElementVNode)('path',{d:'M12 3l1.912 5.813L20 9.5l-4.562 3.937L17 19l-5-3.5L7 19l1.563-5.563L4 9.5l6.088-.687L12 3z',fill:'currentColor',stroke:'none'},null,-1)])])}]]),A={class:'icon',viewBox:'0 0 24 24'};const O={},W=(0,v.A)(O,[['render',function(e,t){return(0,a.openBlock)(),(0,a.createElementBlock)('svg',A,[...t[0]||(t[0]=[(0,a.createElementVNode)('path',{d:'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4'},null,-1),(0,a.createElementVNode)('polyline',{points:'17 8 12 3 7 8'},null,-1),(0,a.createElementVNode)('line',{x1:'12',y1:'3',x2:'12',y2:'15'},null,-1)])])}]]),G={class:'icon',viewBox:'0 0 24 24'};const H={},K=(0,v.A)(H,[['render',function(e,t){return(0,a.openBlock)(),(0,a.createElementBlock)('svg',G,[...t[0]||(t[0]=[(0,a.createElementVNode)('path',{d:'M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2'},null,-1),(0,a.createElementVNode)('circle',{cx:'9',cy:'7',r:'4'},null,-1),(0,a.createElementVNode)('path',{d:'M23 21v-2a4 4 0 0 0-3-3.87'},null,-1),(0,a.createElementVNode)('path',{d:'M16 3.13a4 4 0 0 1 0 7.75'},null,-1)])])}]]),P={class:'collapsible-section'},q={class:'header-title'},J={key:1,class:'badge'},Q={class:'collapsible-content'},X=(Boolean,'model-files');function Y(){return new Promise((e,t)=>{const n=indexedDB.open('live2d-models-db',1);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(X)||t.createObjectStore(X,{keyPath:'id'})}})}async function Z(e,t,n){const a=await Y(),o=function(e,t){return`${e}::${t}`}(e,t);return new Promise((l,c)=>{const s=a.transaction([X],'readwrite').objectStore(X),r=new FileReader;r.onload=()=>{const a={id:o,modelName:e,filename:t,data:r.result,type:n.type,size:n.size,lastModified:n.lastModified},i=s.put(a);i.onsuccess=()=>{console.info(`[IndexedDB] 已存储文件: ${t} (${(n.size/1024).toFixed(2)}KB)`),l(o)},i.onerror=()=>c(i.error)},r.onerror=()=>c(r.error),r.readAsArrayBuffer(n)})}async function ee(){const e=await Y(),t=await new Promise((t,n)=>{const a=e.transaction([X],'readonly').objectStore(X).getAll();a.onsuccess=()=>t(a.result||[]),a.onerror=()=>n(a.error)}),n=t.reduce((e,t)=>'number'==typeof t.size?e+t.size:e+(t.data instanceof ArrayBuffer?t.data.byteLength:0),0);return await new Promise((t,n)=>{const a=e.transaction([X],'readwrite').objectStore(X).clear();a.onsuccess=()=>t(),a.onerror=()=>n(a.error)}),console.info(`[IndexedDB] 已清理所有模型缓存 (${t.length} 个文件，约 ${(n/1024/1024).toFixed(2)} MB)`),{clearedCount:t.length,clearedSize:n}}function te(e,t){return{name:e?`[立绘资源] ${e}`:'[立绘资源]',enabled:!0,strategy:{type:'selective',keys:e?[e,`${e}的立绘`]:['立绘','角色立绘'],keys_secondary:{logic:'and_any',keys:[]},scan_depth:'same_as_global'},position:{type:'after_character_definition',role:'system',depth:0,order:1},content:`\`\`\`json\n${JSON.stringify(t,null,2)}\n\`\`\`\n`,probability:100,recursion:{prevent_incoming:!1,prevent_outgoing:!1,delay_until:null},effect:{sticky:null,cooldown:null,delay:null}}}const ne={class:'page-header'},ae={class:'page-header-actions'},oe=(0,a.defineComponent)({__name:'PageHeader',props:{title:{}},emits:['back'],setup:e=>(t,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',ne,[(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-sm',onClick:n[0]||(n[0]=e=>t.$emit('back'))},[(0,a.createVNode)(f),n[1]||(n[1]=(0,a.createTextVNode)(' 返回 ',-1))]),(0,a.createElementVNode)('h2',null,[(0,a.renderSlot)(t.$slots,'default'),(0,a.createTextVNode)(' '+(0,a.toDisplayString)(e.title),1)]),(0,a.createElementVNode)('div',ae,[(0,a.renderSlot)(t.$slots,'actions',{},()=>[n[2]||(n[2]=(0,a.createElementVNode)('div',{class:'spacer'},null,-1))])])]))}),le={class:'model-upload-wizard'},ce=['disabled'],se={class:'steps-indicator'},re={class:'step-number'},ie={class:'step-label'},me={class:'step-content'},ue={key:0,class:'uploaded-files-preview'},de={class:'files-summary'},pe={key:0,class:'hint'},ve={class:'files-list'},ge={class:'file-name'},fe={key:0,class:'file-source-badge',title:'URL导入'},he=['onClick'],ye={class:'upload-methods-container'},ke={class:'upload-method-section'},be={class:'upload-area-inner'},Ne={class:'upload-placeholder'},Ve={class:'upload-method-section'},Ee={class:'url-upload-area'},xe={class:'url-input-group'},Be=['disabled'],we={class:'step-actions'},Ce=['disabled'],$e={class:'step-content'},Me={key:0,class:'classifying-status'},Se={key:1,class:'classified-files'},De={class:'settings-card'},_e={class:'files-categories'},je={key:0,class:'category-section'},Le={class:'file-category'},Te={key:0,class:'category-item'},Ue={key:1,class:'category-item'},Ie={key:1,class:'category-section'},Re={class:'file-category'},Fe={class:'file-name'},Ae=['onChange'],Oe={key:2,class:'category-section'},ze={class:'file-category'},We=['onClick'],Ge={key:3,class:'category-section'},He={class:'file-category'},Ke={class:'file-name'},Pe={key:0,class:'character-name-badge'},qe=['onChange'],Je={key:4,class:'category-section'},Qe={class:'file-category'},Xe={class:'file-name'},Ye=['onChange'],Ze={key:5,class:'category-section'},et={class:'file-category'},tt={class:'file-name'},nt=['onChange'],at={key:6,class:'category-section'},ot={class:'file-category'},lt={class:'file-name'},ct=['onChange'],st={key:7,class:'category-section'},rt={class:'file-category'},it={class:'step-actions'},mt=['disabled'],ut={class:'step-content'},dt={key:0,class:'model-settings'},pt={class:'settings-card'},vt={class:'setting-item'},gt={class:'setting-item'},ft={key:1,class:'settings-card'},ht={class:'step-actions'},yt={class:'step-content'},kt={class:'resource-settings-list'},bt={class:'resource-entry-content'},Nt={class:'resource-entry-desc'},Vt={class:'resource-entry-badge'},Et={class:'resource-entry-badge'},xt={class:'resource-entry-badge'},Bt={class:'resource-entry-badge'},wt={key:4,class:'no-resources-hint'},Ct={class:'step-content resource-detail-page'},$t={class:'resource-detail-content'},Mt={class:'resource-detail-header'},St={class:'resource-detail-title'},Dt={key:0,class:'animation-settings'},_t={class:'setting-item'},jt=['value'],Lt={class:'setting-item'},Tt=['value'],Ut={class:'setting-item'},It={class:'text-mapping-section'},Rt={class:'text-mapping-header'},Ft={class:'mapping-list'},At={class:'mapping-inputs-vertical'},Ot={class:'text-tags-input-wrapper'},zt=['value','onBlur','onKeydown'],Wt={key:0,class:'text-tags'},Gt=['onClick'],Ht={class:'mapping-selects-row'},Kt={class:'mapping-select-item'},Pt=['onUpdate:modelValue'],qt=['value'],Jt={class:'mapping-select-item'},Qt=['onUpdate:modelValue'],Xt=['value'],Yt=['onClick'],Zt={key:1,class:'sprite-settings'},en={class:'sprite-header'},tn={class:'sprite-name'},nn={key:0,class:'character-name-badge'},an=['onClick'],on={class:'text-mapping-section compact'},ln={class:'mapping-list'},cn={class:'mapping-inputs'},sn={class:'text-tags-input-wrapper'},rn=['value','onBlur','onKeydown'],mn={key:0,class:'text-tags'},un=['onClick'],dn=['onClick'],pn={key:2,class:'background-settings'},vn={class:'resource-header'},gn={class:'resource-name'},fn=['onClick'],hn={class:'text-mapping-section compact'},yn={class:'mapping-list'},kn={class:'mapping-inputs'},bn={class:'text-tags-input-wrapper'},Nn=['value','onBlur','onKeydown'],Vn={key:0,class:'text-tags'},En=['onClick'],xn=['onClick'],Bn={key:3,class:'cg-settings'},wn={class:'resource-header'},Cn={class:'resource-name'},$n=['onClick'],Mn={class:'text-mapping-section compact'},Sn={class:'mapping-list'},Dn={class:'mapping-inputs'},_n={class:'text-tags-input-wrapper'},jn=['value','onBlur','onKeydown'],Ln={key:0,class:'text-tags'},Tn=['onClick'],Un=['onClick'],In={class:'step-content'},Rn={class:'completion-summary'},Fn={class:'summary-details'},An={class:'step-actions'},On=['disabled'],zn={key:0},Wn={key:1},Gn=(0,a.defineComponent)({__name:'ModelUploadWizard',emits:['close','complete'],setup(e,{emit:t}){const n=t,o=[{label:'上传文件'},{label:'分类文件'},{label:'模型设置'},{label:'资源设置'},{label:'完成'}],c=(0,a.ref)(0),s=(0,a.ref)(),u=(0,a.ref)(null),d=(0,a.computed)(()=>{switch(u.value){case'animation':return'动画和表情设置';case'sprite':return'角色立绘设置';case'background':return'背景设置';case'cg':return'CG设置';default:return''}});function p(e){u.value=e}function v(){u.value=null}const g=(0,a.ref)([]),f=(0,a.ref)(''),h=(0,a.ref)(!1),y=(0,a.ref)(!1),b=(0,a.ref)(3),N=(0,a.ref)(''),V=(0,a.ref)(!1),E=(0,a.ref)(!1),x=(0,a.ref)({textures:[],moc3:null,model3:null,cdi3:null,motions:[],sprites:[],backgrounds:[],cgs:[],unclassifiedImages:[],others:[]}),B=(0,a.computed)(()=>x.value.moc3||x.value.model3),w=(0,a.computed)(()=>x.value.motions.filter(e=>'motion'===e.type).length),C=(0,a.computed)(()=>x.value.motions.filter(e=>'expression'===e.type).length),S=(0,a.computed)(()=>{const e=x.value.moc3||x.value.model3,t=x.value.sprites.length>0||x.value.backgrounds.length>0||x.value.cgs.length>0||x.value.textures.length>0,n=x.value.unclassifiedImages.length>0;return''!==f.value.trim()&&(e||t)&&!n});async function D(){if(E.value)return;if(window.confirm('确定要清除已缓存的模型和资源吗？这会删除本地 IndexedDB 缓存，需要重新上传或导入。')){E.value=!0;try{const{clearedCount:e,clearedSize:t}=await ee();if(0===e)return void l().info('当前没有可清理的缓存');l().success(`已清理 ${e} 个缓存文件，释放 ${function(e){if(e<=0)return'0 KB';const t=e/1048576;return t>=1?`${t.toFixed(2)} MB`:`${(e/1024).toFixed(2)} KB`}(t)}`)}catch(e){const t=e instanceof Error?e.message:'未知错误';console.error('清理 IndexedDB 缓存失败:',e),l().error(`清理失败：${t}`)}finally{E.value=!1}}}function j(){s.value?.click()}function L(e){const t=e.target,n=t.files;if(n&&n.length>0){const e=Array.from(n),t=new Set(g.value.map(e=>e.file.name)),a=e.filter(e=>!t.has(e.name));g.value.push(...a.map(e=>({file:e,sourceUrl:void 0}))),a.length<e.length&&l().info(`已跳过 ${e.length-a.length} 个重复文件`)}t.value=''}function T(e){const t=e.dataTransfer?.files;if(t&&t.length>0){const e=Array.from(t),n=new Set(g.value.map(e=>e.file.name)),a=e.filter(e=>!n.has(e.name));g.value.push(...a.map(e=>({file:e,sourceUrl:void 0}))),a.length<e.length&&l().info(`已跳过 ${e.length-a.length} 个重复文件`)}}function U(){g.value=[]}async function I(){const e=N.value.trim();if(e){V.value=!0;try{const t=e.split(/[,\n;]/).map(e=>e.trim()).filter(e=>e.length>0);if(1===t.length&&function(e){try{const t=new URL(e);return'github.com'===t.hostname||'raw.githubusercontent.com'===t.hostname||t.hostname.endsWith('.github.io')}catch{return!1}}(t[0]))try{return await async function(e){let t=e.trim();t.endsWith('/')||(t+='/');try{const e=new URL(t);if('github.com'===e.hostname){const n=e.pathname.split('/').filter(e=>e);if(n.length>=2){const[e,a,...o]=n;if(0===o.length||'tree'===o[0]||'blob'===o[0]){const n=o.length>2?o.slice(2).join('/')+'/':'';t=`https://${e}.github.io/${a}/${n.replace(/[^/]+\.(json|moc3|png)$/,'')}`}}}if('raw.githubusercontent.com'===e.hostname){const n=e.pathname.split('/').filter(e=>e);if(n.length>=3){const[e,a,o,...l]=n;if(l.length>0){(t.includes('.json')||t.includes('.moc3')||t.includes('.png'))&&l.pop();t=`https://${e}.github.io/${a}/${l.length>0?l.join('/')+'/':''}`}else t=`https://${e}.github.io/${a}/`}}}catch(e){console.warn('URL 规范化失败，使用原始 URL:',e)}l().info('正在解析GitHub仓库结构...');let n='',a='',o=!0;for(const e of i){for(const l of m){const c=new URL(t).pathname.split('/').filter(e=>e&&'models'!==e&&'model'!==e);if(c.length>0){const s=c[c.length-1].replace(/\/$/,''),r=`${t}${e}${s}.${l}`;try{if((await fetch(r,{method:'HEAD'})).ok){n=r,a=s,o='model3.json'===l;break}}catch{}}}if(n)break}if(!n)for(const e of['model','character','live2d']){for(const l of m){const c=`${t}${e}.${l}`;try{if((await fetch(c,{method:'HEAD'})).ok){n=c,a=e,o='model3.json'===l;break}}catch{}}if(n)break}if(!n)throw new Error('未能自动找到模型配置文件，请直接输入 model3.json 的完整URL');const c=await fetch(n);if(!c.ok)throw new Error(`无法加载模型配置文件: ${c.statusText}`);const s=await c.json(),r=n.substring(0,n.lastIndexOf('/')+1);if(!a||'model'===a){const e=s.FileReferences;if(e?.Moc){const t=e.Moc.match(/[\\/]([^\\/]+)\.moc3?$/);t&&(a=t[1])}a&&'model'!==a||(a=n.split('/').pop()?.replace(/\.(model3|model)\.json$/,'')||'unknown')}const u=[{url:n,filename:n.split('/').pop()||'model3.json'}],d=s.FileReferences;if(d){if(d.Moc){const e=d.Moc,t=e.startsWith('http')?e:new URL(e,r).href;u.push({url:t,filename:e.split('/').pop()||'model.moc3'})}if(Array.isArray(d.Textures))for(const e of d.Textures){const t=e.startsWith('http')?e:new URL(e,r).href;u.push({url:t,filename:e.split('/').pop()||'texture.png'})}if(d.DisplayInfo){const e=d.DisplayInfo,t=e.startsWith('http')?e:new URL(e,r).href;u.push({url:t,filename:e.split('/').pop()||'cdi3.json'})}if(o&&d.Groups&&Array.isArray(d.Groups)){const e=d.Groups;for(const t of e)if(Array.isArray(t.Files))for(const e of t.Files){const t=e.startsWith('http')?e:new URL(e,r).href;u.push({url:t,filename:e.split('/').pop()||'motion.json'})}else if(t.File&&'string'==typeof t.File){const e=t.File,n=e.startsWith('http')?e:new URL(e,r).href;u.push({url:n,filename:e.split('/').pop()||'motion.json'})}}}const p=new Set(g.value.map(e=>e.file.name));let v=0,f=0;for(const e of u)try{if(p.has(e.filename)){console.info(`已跳过重复文件: ${e.filename}`);continue}const t=await fetch(e.url);if(!t.ok){console.warn(`无法下载文件: ${e.url}`),f++;continue}const n=await t.blob(),a=new File([n],e.filename,{type:n.type});g.value.push({file:a,sourceUrl:e.url}),p.add(e.filename),v++}catch(t){console.warn(`下载文件失败 ${e.url}:`,t),f++}N.value='',v>0&&l().success(`成功从GitHub仓库导入 ${v} 个文件`);f>0&&l().warning(`导入失败 ${f} 个文件`);if(0===v)throw new Error('未能导入任何文件')}(t[0]),void(N.value='')}catch(e){console.warn('GitHub仓库解析失败，降级为普通URL导入:',e),l().info('GitHub仓库解析失败，尝试作为普通URL导入...')}const n=new Set(g.value.map(e=>e.file.name));let a=0,o=0;for(const e of t)try{const t=await fetch(e);if(!t.ok){console.error(`无法下载文件: ${e}`,t.statusText),o++;continue}const l=await t.blob();let c=e.split('/').pop()||'unknown';const s=t.headers.get('Content-Disposition');if(s){const e=s.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);e&&e[1]&&(c=e[1].replace(/['"]/g,''))}if(!c.match(/\.[a-z0-9]+$/i)){const e=t.headers.get('Content-Type');if(e){c+={'image/png':'.png','image/jpeg':'.jpg','image/jpg':'.jpg','application/json':'.json','application/octet-stream':'.moc3'}[e]||''}}if(n.has(c)){console.info(`已跳过重复文件: ${c}`);continue}const r=new File([l],c,{type:l.type});g.value.push({file:r,sourceUrl:e}),n.add(c),a++}catch(t){console.error(`导入URL失败: ${e}`,t),o++}N.value='',a>0&&l().success(`成功导入 ${a} 个文件`),o>0&&l().warning(`导入失败 ${o} 个文件，请检查URL是否正确`)}catch(e){console.error('URL导入失败:',e);const t=e instanceof Error?e.message:'未知错误';l().error(`URL导入失败: ${t}`)}finally{V.value=!1}}else l().warning('请输入URL')}function R(e){const t=(e instanceof File?e.name:e.file.name).toLowerCase();return t.endsWith('.moc3')?'type-moc3':t.endsWith('.model3.json')?'type-model3':t.endsWith('.cdi3.json')?'type-cdi3':t.endsWith('.motion3.json')?'type-motion':t.match(/\.(png|jpg|jpeg)$/)?'type-image':'type-other'}function F(e){const t=(e instanceof File?e.name:e.file.name).toLowerCase();return t.endsWith('.moc3')?'MOC':t.endsWith('.model3.json')?'模型配置':t.endsWith('.cdi3.json')?'显示信息':t.endsWith('.motion3.json')?'动作/表情':t.match(/\.(png|jpg|jpeg)$/)?'图片':'其他'}async function A(){0!==g.value.length&&(await H(),c.value<o.length-1&&c.value++)}async function O(){if(0===c.value){if(0===g.value.length)return;await H()}c.value<o.length-1&&c.value++}function G(){c.value>0&&c.value--}async function H(){h.value=!0;try{if(!f.value){const e=g.value.find(e=>e.file.name.endsWith('.model3.json')||e.file.name.endsWith('.moc3'));if(e)f.value=e.file.name.replace(/\.(model3\.json|moc3)$/,'');else{const e=g.value[0];f.value=e&&e.file.name.replace(/\.[^.]*$/,'')||'新资源'}}const e=g.value.map(e=>{const t=e.file,n=t.name.toLowerCase();let a='other',o=!1;return n.endsWith('.moc3')?a='moc3':n.endsWith('.model3.json')?a='model3':n.endsWith('.cdi3.json')?a='cdi3':n.endsWith('.motion3.json')?(a=function(e){const t=e.toLowerCase(),n=[/_e\./i,/\.e\./i,/expression/i,/表情/i,/exp/i,/f\d+/i,/^expr/i],a=[/_m\./i,/\.m\./i,/motion/i,/动作/i,/mot/i,/idle/i,/tap/i,/touch/i];for(const e of n)if(e.test(t))return'expression';for(const e of a)if(e.test(t))return'motion';return'motion'}(t.name),o=!/_e\.|\.e\.|expression|表情|_m\.|\.m\.|motion|动作/i.test(t.name)):n.match(/\.(png|jpg|jpeg)$/)&&(a='unclassified_image'),{name:t.name,file:t,sourceUrl:e.sourceUrl,type:a,canToggle:o,characterName:undefined}});x.value={textures:[],moc3:e.find(e=>'moc3'===e.type)||null,model3:e.find(e=>'model3'===e.type)||null,cdi3:e.find(e=>'cdi3'===e.type)||null,motions:e.filter(e=>'motion'===e.type||'expression'===e.type),sprites:[],backgrounds:[],cgs:[],unclassifiedImages:e.filter(e=>'unclassified_image'===e.type),others:e.filter(e=>'other'===e.type)},Gn.value=x.value.sprites.map(e=>({name:e.name,file:e.file,characterName:e.characterName,textMappings:[]})),Hn.value=x.value.backgrounds.map(e=>({name:e.name,file:e.file,textMappings:[]})),Kn.value=x.value.cgs.map(e=>({name:e.name,file:e.file,textMappings:[]}))}catch(e){console.error('分类文件失败:',e),l().error('分类文件失败')}finally{h.value=!1}}function K(e,t,n){if(n===e)return;let a,o;if('sprite'===e){if(o=x.value.sprites.findIndex(e=>e.name===t),-1!==o){a=x.value.sprites[o],x.value.sprites.splice(o,1);const e=Gn.value.findIndex(e=>e.name===t);e>=0&&Gn.value.splice(e,1)}}else if('background'===e){if(o=x.value.backgrounds.findIndex(e=>e.name===t),-1!==o){a=x.value.backgrounds[o],x.value.backgrounds.splice(o,1);const e=Hn.value.findIndex(e=>e.name===t);e>=0&&Hn.value.splice(e,1)}}else if('cg'===e){if(o=x.value.cgs.findIndex(e=>e.name===t),-1!==o){a=x.value.cgs[o],x.value.cgs.splice(o,1);const e=Kn.value.findIndex(e=>e.name===t);e>=0&&Kn.value.splice(e,1)}}else'texture'===e&&(o=x.value.textures.findIndex(e=>e.name===t),-1!==o&&(a=x.value.textures[o],x.value.textures.splice(o,1)));if(a)if(a.type='unclassified_image',a.characterName&&'sprite'!==n&&(a.characterName=void 0),'unclassified'===n)x.value.unclassifiedImages.push(a),l().info(`已将 "${a.name}" 移回待分类`);else{if(a.type=n,'sprite'===n){const e=a.name.match(/([^_/\\]+?)[_-]?(sprite|立绘|stand|portrait)/i);e&&e[1]&&(a.characterName=e[1])}'sprite'===n?(x.value.sprites.push(a),Gn.value.push({name:a.name,file:a.file,characterName:a.characterName,textMappings:[]})):'background'===n?(x.value.backgrounds.push(a),Hn.value.push({name:a.name,file:a.file,textMappings:[]})):'cg'===n?(x.value.cgs.push(a),Kn.value.push({name:a.name,file:a.file,textMappings:[]})):'texture'===n&&x.value.textures.push(a),l().success(`已将 "${a.name}" 重新分类为${'sprite'===n?'立绘':'background'===n?'背景':'cg'===n?'CG':'纹理'}`)}else console.warn(`未找到文件: ${t} 在分类 ${e} 中`)}const P=(0,a.ref)('none'),q=(0,a.ref)('none'),J=(0,a.ref)(!0),Q=(0,a.ref)([]),X=(0,a.computed)(()=>x.value.motions.filter(e=>'motion'===e.type).map(e=>({name:qn(e.name),file:e.file}))),Y=(0,a.computed)(()=>x.value.motions.filter(e=>'expression'===e.type).map(e=>({name:qn(e.name),file:e.file})));function ne(){Q.value.push({text:'',textTags:[],expression:'none',motion:'none'})}function ae(e){return e.split(';').map(e=>e.trim()).filter(e=>e.length>0)}const Gn=(0,a.ref)([]),Hn=(0,a.ref)([]),Kn=(0,a.ref)([]);async function Pn(){if(!S.value)return void l().warning('请先完成所有必填项');y.value=!0;const e=[],t=[];let a=0,o=0;try{l().info('正在保存文件并创建世界书条目...');const c=[];for(const e of x.value.textures)try{if(e.sourceUrl)c.push({type:'texture',filename:e.file.name,url:e.sourceUrl}),a++;else{const t=await Z(f.value,e.file.name,e.file);c.push({type:'texture',fileId:t,filename:e.file.name}),a++}}catch(n){const a=n instanceof Error?n.message:String(n);t.push(`纹理文件 "${e.file.name}": ${a}`),console.error(`存储纹理文件失败: ${e.file.name}`,n),o++}if(x.value.moc3)try{if(x.value.moc3.sourceUrl)c.push({type:'moc3',filename:x.value.moc3.file.name,url:x.value.moc3.sourceUrl}),a++;else{const e=await Z(f.value,x.value.moc3.file.name,x.value.moc3.file);c.push({type:'moc3',fileId:e,filename:x.value.moc3.file.name}),a++}}catch(e){const n=e instanceof Error?e.message:String(e);t.push(`模型文件 "${x.value.moc3.file.name}": ${n}`),console.error(`存储 moc3 文件失败: ${x.value.moc3.file.name}`,e),o++}if(x.value.model3)try{if(x.value.model3.sourceUrl)c.push({type:'model3',filename:x.value.model3.file.name,url:x.value.model3.sourceUrl}),a++;else{const e=await Z(f.value,x.value.model3.file.name,x.value.model3.file);c.push({type:'model3',fileId:e,filename:x.value.model3.file.name}),a++}}catch(e){const n=e instanceof Error?e.message:String(e);t.push(`模型文件 "${x.value.model3.file.name}": ${n}`),console.error(`存储 model3 文件失败: ${x.value.model3.file.name}`,e),o++}if(x.value.cdi3)try{if(x.value.cdi3.sourceUrl)c.push({type:'cdi3',filename:x.value.cdi3.file.name,url:x.value.cdi3.sourceUrl}),a++;else{const e=await Z(f.value,x.value.cdi3.file.name,x.value.cdi3.file);c.push({type:'cdi3',fileId:e,filename:x.value.cdi3.file.name}),a++}}catch(e){const n=e instanceof Error?e.message:String(e);t.push(`显示信息文件 "${x.value.cdi3.file.name}": ${n}`),console.error(`存储 cdi3 文件失败: ${x.value.cdi3.file.name}`,e),o++}const s=[];for(const e of x.value.motions.filter(e=>'motion'===e.type||'expression'===e.type))try{if(e.sourceUrl)s.push({name:qn(e.name),filename:e.file.name,url:e.sourceUrl,type:e.type}),a++;else{const t=await Z(f.value,e.file.name,e.file);s.push({name:qn(e.name),fileId:t,filename:e.file.name,type:e.type}),a++}}catch(n){const a=n instanceof Error?n.message:String(n);t.push(`${'motion'===e.type?'动作':'表情'}文件 "${e.file.name}": ${a}`),console.error(`存储动作文件失败: ${e.file.name}`,n),o++}const i=new Map;for(const e of Gn.value)try{const t=x.value.sprites.find(t=>t.name===e.name),n=e.characterName||'default';i.has(n)||i.set(n,[]);const o=(e.textMappings||[]).map(e=>e.text.trim()).filter(e=>e.length>0);if(t?.sourceUrl)i.get(n).push({name:e.name,filename:e.file.name,url:t.sourceUrl,textMappings:o}),a++;else{const t=await Z(f.value,e.file.name,e.file);i.get(n).push({name:e.name,fileId:t,filename:e.file.name,textMappings:o}),a++}}catch(n){const a=n instanceof Error?n.message:String(n);t.push(`立绘文件 "${e.file.name}": ${a}`),console.error(`存储立绘文件失败: ${e.file.name}`,n),o++}const m=[];for(const e of Hn.value)try{const t=x.value.backgrounds.find(t=>t.name===e.name),n=(e.textMappings||[]).map(e=>e.text.trim()).filter(e=>e.length>0);if(t?.sourceUrl)m.push({name:e.name,filename:e.file.name,url:t.sourceUrl,textMappings:n}),a++;else{const t=await Z(f.value,e.file.name,e.file);m.push({name:e.name,fileId:t,filename:e.file.name,textMappings:n}),a++}}catch(n){const a=n instanceof Error?n.message:String(n);t.push(`背景文件 "${e.file.name}": ${a}`),console.error(`存储背景文件失败: ${e.file.name}`,n),o++}const u=[];for(const e of Kn.value)try{const t=x.value.cgs.find(t=>t.name===e.name),n=(e.textMappings||[]).map(e=>e.text.trim()).filter(e=>e.length>0);if(t?.sourceUrl)u.push({name:e.name,filename:e.file.name,url:t.sourceUrl,textMappings:n}),a++;else{const t=await Z(f.value,e.file.name,e.file);u.push({name:e.name,fileId:t,filename:e.file.name,textMappings:n}),a++}}catch(n){const a=n instanceof Error?n.message:String(n);t.push(`CG文件 "${e.file.name}": ${a}`),console.error(`存储CG文件失败: ${e.file.name}`,n),o++}const d=[];if(c.some(e=>'model3'===e.type||'moc3'===e.type))try{const e=c.find(e=>'model3'===e.type),t=c.find(e=>'moc3'===e.type),n=c.find(e=>'cdi3'===e.type),a=c.filter(e=>'texture'===e.type),o=s.filter(e=>'motion'===e.type).map(e=>({name:e.name,file:e.url||`indexeddb://${f.value}/${e.filename}`,group:'default'})),l=s.filter(e=>'expression'===e.type).map(e=>({name:e.name,file:e.url||`indexeddb://${f.value}/${e.filename}`})),r={};P.value&&'none'!==P.value&&(r.expression=P.value),q.value&&'none'!==q.value&&(r.motion=q.value,r.autoLoop=J.value);const i={},m={},u={};for(const e of Q.value){const t=e.text.trim();if(t){if(e.expression&&'none'!==e.expression){const n=l.find(t=>t.name===e.expression);if(n){m[n.file.split('/').pop()||`${e.expression}.exp3.json`]=t}}if(e.motion&&'none'!==e.motion){const n=o.find(t=>t.name===e.motion);if(n){u[n.file.split('/').pop()||`${e.motion}.motion3.json`]=t}}}}Object.keys(m).length>0&&(i.expression=m),Object.keys(u).length>0&&(i.motion=u);const p=function(e,t){return{name:`[模型资源] ${e}`,enabled:!0,strategy:{type:'selective',keys:[`__MODEL_RESOURCE_${e}_${Date.now()}__`],keys_secondary:{logic:'and_any',keys:[]},scan_depth:'same_as_global'},position:{type:'after_character_definition',role:'system',depth:0,order:0},content:`\`\`\`json\n${JSON.stringify(t,null,2)}\n\`\`\`\n`,probability:100,recursion:{prevent_incoming:!0,prevent_outgoing:!0,delay_until:null},effect:{sticky:null,cooldown:null,delay:null}}}(f.value,{type:'live2d_model',modelName:f.value,files:{model3:e?e.url||`indexeddb://${f.value}/${e.filename}`:void 0,moc3:t?t.url||`indexeddb://${f.value}/${t.filename}`:void 0,textures:a.map(e=>e.url||`indexeddb://${f.value}/${e.filename}`),cdi3:n?n.url||`indexeddb://${f.value}/${n.filename}`:void 0},motions:o,expressions:l,defaultAnimation:Object.keys(r).length>0?r:void 0,textMappings:Object.keys(i).length>0?i:void 0});d.push(p)}catch(e){const n=e instanceof Error?e.message:String(e);t.push(`创建模型资源世界书条目失败: ${n}`),console.error('创建模型资源世界书条目失败:',e)}for(const[e,t]of i.entries())if(t.length>0){const n=te('default'===e?'':e,{type:'sprite',characterName:'default'===e?void 0:e,sprites:t.map(t=>({name:t.name,file:t.url?t.url:e&&'default'!==e?`indexeddb://${e}/${t.filename}`:`indexeddb://${f.value}/${t.filename}`,textMappings:t.textMappings.length>0?t.textMappings:void 0}))});d.push(n)}if(m.length>0){const e=function(e){const t=['背景','场景'];for(const n of e.backgrounds)n.textMappings&&t.push(...n.textMappings),t.push(n.name);return{name:'[背景资源]',enabled:!0,strategy:{type:'selective',keys:[...new Set(t)],keys_secondary:{logic:'and_any',keys:[]},scan_depth:'same_as_global'},position:{type:'after_character_definition',role:'system',depth:0,order:2},content:`\`\`\`json\n${JSON.stringify(e,null,2)}\n\`\`\`\n`,probability:100,recursion:{prevent_incoming:!1,prevent_outgoing:!1,delay_until:null},effect:{sticky:null,cooldown:null,delay:null}}}({type:'background',backgrounds:m.map(e=>({name:e.name,file:e.url||`indexeddb://backgrounds/${e.filename}`,textMappings:e.textMappings.length>0?e.textMappings:void 0}))});d.push(e)}if(u.length>0){const e=function(e){const t=['CG','cg'];for(const n of e.cgs)n.textMappings&&t.push(...n.textMappings),t.push(n.name);return{name:'[CG资源]',enabled:!0,strategy:{type:'selective',keys:[...new Set(t)],keys_secondary:{logic:'and_any',keys:[]},scan_depth:'same_as_global'},position:{type:'after_character_definition',role:'system',depth:0,order:3},content:`\`\`\`json\n${JSON.stringify(e,null,2)}\n\`\`\`\n`,probability:100,recursion:{prevent_incoming:!1,prevent_outgoing:!1,delay_until:null},effect:{sticky:null,cooldown:null,delay:null}}}({type:'cg',cgs:u.map(e=>({name:e.name,file:e.url||`indexeddb://cgs/${e.filename}`,textMappings:e.textMappings.length>0?e.textMappings:void 0}))});d.push(e)}if(d.length>0)try{let e=null;try{const t=getCharWorldbookNames('current');e=t.primary||t.additional[0]||null}catch(e){console.warn('获取角色卡世界书失败，使用默认世界书:',e)}e||(e=r);try{await getWorldbook(e)}catch{try{await createWorldbook(e,[])}catch(t){if(console.warn(`创建世界书 ${e} 失败:`,t),e===r)throw t;e=r;try{await getWorldbook(r)}catch{await createWorldbook(r,[])}}}await createWorldbookEntries(e,d),console.info(`已在世界书 ${e} 中创建 ${d.length} 个资源世界书条目`)}catch(e){const n=e instanceof Error?e.message:String(e);t.push(`创建资源世界书条目失败: ${n}`),console.error('创建资源世界书条目失败:',e),l().warning('创建资源世界书条目时出现问题，但文件已保存')}const p={name:f.value,files:c.map(e=>({type:e.type,url:e.url||'',filename:e.filename,fileId:e.fileId,isLocal:!e.url})),motions:s.map(e=>({name:e.name,url:e.url||'',type:e.type,fileId:e.fileId,isLocal:!e.url}))};for(const t of e)try{URL.revokeObjectURL(t)}catch(e){console.warn('清理 Object URL 失败:',e)}const v=Gn.value.length+Hn.value.length+Kn.value.length,g=v>0?`，包含 ${v} 个资源文件`:'';if(0===o)l().success(`模型 "${f.value}" 已成功创建世界书条目并保存文件${g}`);else{if(!(a>0))return l().error('保存失败：所有文件都未能成功保存'),t.length>0&&(console.group('文件保存错误详情'),t.forEach((e,t)=>{console.error(`${t+1}. ${e}`)}),console.groupEnd()),void(y.value=!1);l().warning(`模型 "${f.value}" 已部分完成：成功 ${a} 个，失败 ${o} 个${g}`),t.length>0&&(console.group('文件保存错误详情'),t.forEach((e,t)=>{console.error(`${t+1}. ${e}`)}),console.groupEnd())}setTimeout(()=>{n('complete',p)},500)}catch(n){for(const t of e)try{URL.revokeObjectURL(t)}catch(e){console.warn('清理 Object URL 失败:',e)}const a=n instanceof Error?n.message:String(n);console.error('创建世界书条目失败:',n),l().error(`创建世界书条目失败: ${a}`),t.length>0&&(console.group('错误详情'),t.forEach((e,t)=>{console.error(`${t+1}. ${e}`)}),console.groupEnd())}finally{y.value=!1}}function qn(e){return e.replace(/\.motion3?\.json$/i,'').replace(/^\d+_/,'').replace(/_m$/i,'').replace(/_e$/i,'').replace(/_motion$/i,'').replace(/_expression$/i,'')}return(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',le,[(0,a.createVNode)(oe,{title:'游戏设置',onBack:t[0]||(t[0]=t=>e.$emit('close'))},{actions:(0,a.withCtx)(()=>[(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-sm',disabled:E.value,onClick:D},(0,a.toDisplayString)(E.value?'清理中...':'清除缓存'),9,ce)]),default:(0,a.withCtx)(()=>[(0,a.createVNode)((0,a.unref)(W))]),_:1}),(0,a.createCommentVNode)(' 步骤指示器 '),(0,a.createElementVNode)('div',se,[((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(o,(e,t)=>(0,a.createElementVNode)('div',{key:t,class:(0,a.normalizeClass)(['step-item',{active:c.value===t,completed:c.value>t}])},[(0,a.createElementVNode)('div',re,(0,a.toDisplayString)(t+1),1),(0,a.createElementVNode)('div',ie,(0,a.toDisplayString)(e.label),1)],2)),64))]),(0,a.createCommentVNode)(' 步骤1: 上传文件 '),(0,a.withDirectives)((0,a.createElementVNode)('div',me,[(0,a.createCommentVNode)(' 统一显示所有已上传文件列表 '),g.value.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',ue,[(0,a.createElementVNode)('div',de,[(0,a.createElementVNode)('p',null,[(0,a.createTextVNode)(' 已选择 '+(0,a.toDisplayString)(g.value.length)+' 个文件（可混合使用本地文件和URL导入） ',1),g.value.some(e=>e.sourceUrl)?((0,a.openBlock)(),(0,a.createElementBlock)('span',pe,' - '+(0,a.toDisplayString)(g.value.filter(e=>e.sourceUrl).length)+' 个来自URL ',1)):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-sm',onClick:U},'清空')]),(0,a.createElementVNode)('div',ve,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(g.value,(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:`${e.file.name}-${t}`,class:'file-item'},[(0,a.createElementVNode)('span',ge,(0,a.toDisplayString)(e.file.name),1),e.sourceUrl?((0,a.openBlock)(),(0,a.createElementBlock)('span',fe,'URL')):(0,a.createCommentVNode)('v-if',!0),(0,a.createElementVNode)('span',{class:(0,a.normalizeClass)(['file-type-badge',R(e.file)])},(0,a.toDisplayString)(F(e.file)),3),(0,a.createElementVNode)('button',{class:'remove-file-btn',title:'移除',onClick:(0,a.withModifiers)(e=>function(e){g.value.splice(e,1)}(t),['stop'])},[(0,a.createVNode)((0,a.unref)(M),{class:'icon-sm'})],8,he)]))),128))])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 上传方式：本地文件和URL导入并排显示 '),(0,a.createElementVNode)('div',ye,[(0,a.createCommentVNode)(' 本地文件上传 '),(0,a.createElementVNode)('div',ke,[t[17]||(t[17]=(0,a.createElementVNode)('h3',{class:'method-title'},'本地文件上传',-1)),(0,a.createElementVNode)('div',{class:'upload-area',onClick:j,onDragover:t[1]||(t[1]=(0,a.withModifiers)(()=>{},['prevent'])),onDrop:(0,a.withModifiers)(T,['prevent'])},[(0,a.createElementVNode)('input',{ref_key:'fileInputRef',ref:s,type:'file',class:'hidden-input',accept:'.png,.jpg,.jpeg,.moc3,.model3.json,.cdi3.json,.motion3.json,.physics3.json',multiple:'',onChange:L},null,544),(0,a.createElementVNode)('div',be,[(0,a.createElementVNode)('div',Ne,[(0,a.createVNode)((0,a.unref)(W),{class:'icon-lg'}),t[14]||(t[14]=(0,a.createElementVNode)('p',null,'点击或拖拽文件到这里上传',-1)),t[15]||(t[15]=(0,a.createElementVNode)('p',{class:'hint'},'支持模型文件（.moc3, .model3.json等）',-1)),t[16]||(t[16]=(0,a.createElementVNode)('p',{class:'hint'},'支持图片文件（.png, .jpg等）',-1))])])],32)]),(0,a.createCommentVNode)(' URL导入 '),(0,a.createElementVNode)('div',Ve,[t[21]||(t[21]=(0,a.createElementVNode)('h3',{class:'method-title'},'URL导入',-1)),(0,a.createElementVNode)('div',Ee,[(0,a.createElementVNode)('div',xe,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':t[2]||(t[2]=e=>N.value=e),type:'text',class:'url-input',placeholder:'请输入文件URL（支持图片和模型文件）',onKeyup:(0,a.withKeys)(I,['enter'])},null,544),[[a.vModelText,N.value]]),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-primary',disabled:!N.value.trim()||V.value,onClick:I},(0,a.toDisplayString)(V.value?'导入中...':'导入'),9,Be)]),t[18]||(t[18]=(0,a.createElementVNode)('p',{class:'hint'},'可以输入多个URL，每行一个，或使用逗号/分号分隔',-1)),t[19]||(t[19]=(0,a.createElementVNode)('p',{class:'hint'},'支持 GitHub 仓库，自动解析文件结构',-1)),t[20]||(t[20]=(0,a.createElementVNode)('p',{class:'hint'},'导入的文件会与本地文件合并显示',-1))])])]),(0,a.createElementVNode)('div',we,[(0,a.createElementVNode)('button',{class:'bubble-btn',onClick:t[3]||(t[3]=t=>e.$emit('close'))},'取消'),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-primary',disabled:0===g.value.length,onClick:A},' 完成上传并分类文件 ',8,Ce)])],512),[[a.vShow,0===c.value]]),(0,a.createCommentVNode)(' 步骤2: 分类和确认 '),(0,a.withDirectives)((0,a.createElementVNode)('div',$e,[h.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',Me,[...t[22]||(t[22]=[(0,a.createElementVNode)('p',null,'正在自动分类文件...',-1)])])):((0,a.openBlock)(),(0,a.createElementBlock)('div',Se,[(0,a.createCommentVNode)(' 资源名称输入 '),(0,a.createElementVNode)('div',De,[t[23]||(t[23]=(0,a.createElementVNode)('h3',null,'资源名称',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':t[4]||(t[4]=e=>f.value=e),type:'text',placeholder:'请输入资源名称',class:'model-name-input'},null,512),[[a.vModelText,f.value]]),t[24]||(t[24]=(0,a.createElementVNode)('p',{class:'hint'},'资源名称将用于世界书条目和配置（可以是模型名、角色名等）',-1))]),(0,a.createCommentVNode)(' 文件分类显示 '),(0,a.createElementVNode)('div',_e,[(0,a.createCommentVNode)(' 模型文件 '),x.value.moc3||x.value.model3?((0,a.openBlock)(),(0,a.createElementBlock)('div',je,[t[25]||(t[25]=(0,a.createElementVNode)('h3',null,'模型文件',-1)),(0,a.createElementVNode)('div',Le,[x.value.model3?((0,a.openBlock)(),(0,a.createElementBlock)('div',Te,[(0,a.createVNode)((0,a.unref)(k),{class:'icon-sm'}),(0,a.createElementVNode)('span',null,(0,a.toDisplayString)(x.value.model3.name),1)])):(0,a.createCommentVNode)('v-if',!0),x.value.moc3?((0,a.openBlock)(),(0,a.createElementBlock)('div',Ue,[(0,a.createVNode)((0,a.unref)(k),{class:'icon-sm'}),(0,a.createElementVNode)('span',null,(0,a.toDisplayString)(x.value.moc3.name),1)])):(0,a.createCommentVNode)('v-if',!0)])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 纹理文件 '),x.value.textures.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',Ie,[(0,a.createElementVNode)('h3',null,'纹理文件 ('+(0,a.toDisplayString)(x.value.textures.length)+')',1),(0,a.createElementVNode)('div',Re,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(x.value.textures,e=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e.name,class:'category-item category-item-with-select'},[(0,a.createVNode)((0,a.unref)(k),{class:'icon-sm'}),(0,a.createElementVNode)('span',Fe,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)('select',{value:'texture',class:'classify-select',onChange:t=>K('texture',e.name,t.target.value)},[...t[26]||(t[26]=[(0,a.createStaticVNode)('<option value="texture" data-v-2e302650>纹理</option><option value="sprite" data-v-2e302650>立绘</option><option value="background" data-v-2e302650>背景</option><option value="cg" data-v-2e302650>CG</option><option value="unclassified" data-v-2e302650>待分类</option>',5)])],40,Ae)]))),128))])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 动作文件 '),x.value.motions.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',Oe,[(0,a.createElementVNode)('h3',null,'动作文件 ('+(0,a.toDisplayString)(x.value.motions.length)+')',1),(0,a.createElementVNode)('div',ze,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(x.value.motions,e=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e.name,class:'category-item'},[(0,a.createVNode)((0,a.unref)(k),{class:'icon-sm'}),(0,a.createElementVNode)('span',null,(0,a.toDisplayString)(e.name),1),e.canToggle?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'toggle-type-btn',onClick:t=>function(e){'motion'===e.type?e.type='expression':e.type='motion'}(e)},(0,a.toDisplayString)('motion'===e.type?'改为表情':'改为动作'),9,We)):(0,a.createCommentVNode)('v-if',!0)]))),128))])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 立绘文件 '),x.value.sprites.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',Ge,[(0,a.createElementVNode)('h3',null,'角色立绘 ('+(0,a.toDisplayString)(x.value.sprites.length)+')',1),(0,a.createElementVNode)('div',He,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(x.value.sprites,e=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e.name,class:'category-item category-item-with-select'},[(0,a.createVNode)((0,a.unref)(k),{class:'icon-sm'}),(0,a.createElementVNode)('span',Ke,(0,a.toDisplayString)(e.name),1),e.characterName?((0,a.openBlock)(),(0,a.createElementBlock)('span',Pe,(0,a.toDisplayString)(e.characterName),1)):(0,a.createCommentVNode)('v-if',!0),(0,a.createElementVNode)('select',{value:'sprite',class:'classify-select',onChange:t=>K('sprite',e.name,t.target.value)},[...t[27]||(t[27]=[(0,a.createStaticVNode)('<option value="sprite" data-v-2e302650>立绘</option><option value="background" data-v-2e302650>背景</option><option value="cg" data-v-2e302650>CG</option><option value="texture" data-v-2e302650>纹理</option><option value="unclassified" data-v-2e302650>待分类</option>',5)])],40,qe)]))),128))])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 背景文件 '),x.value.backgrounds.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',Je,[(0,a.createElementVNode)('h3',null,'背景 ('+(0,a.toDisplayString)(x.value.backgrounds.length)+')',1),(0,a.createElementVNode)('div',Qe,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(x.value.backgrounds,e=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e.name,class:'category-item category-item-with-select'},[(0,a.createVNode)((0,a.unref)(k),{class:'icon-sm'}),(0,a.createElementVNode)('span',Xe,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)('select',{value:'background',class:'classify-select',onChange:t=>K('background',e.name,t.target.value)},[...t[28]||(t[28]=[(0,a.createStaticVNode)('<option value="background" data-v-2e302650>背景</option><option value="sprite" data-v-2e302650>立绘</option><option value="cg" data-v-2e302650>CG</option><option value="texture" data-v-2e302650>纹理</option><option value="unclassified" data-v-2e302650>待分类</option>',5)])],40,Ye)]))),128))])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' CG文件 '),x.value.cgs.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',Ze,[(0,a.createElementVNode)('h3',null,'CG ('+(0,a.toDisplayString)(x.value.cgs.length)+')',1),(0,a.createElementVNode)('div',et,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(x.value.cgs,e=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e.name,class:'category-item category-item-with-select'},[(0,a.createVNode)((0,a.unref)(k),{class:'icon-sm'}),(0,a.createElementVNode)('span',tt,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)('select',{value:'cg',class:'classify-select',onChange:t=>K('cg',e.name,t.target.value)},[...t[29]||(t[29]=[(0,a.createStaticVNode)('<option value="cg" data-v-2e302650>CG</option><option value="sprite" data-v-2e302650>立绘</option><option value="background" data-v-2e302650>背景</option><option value="texture" data-v-2e302650>纹理</option><option value="unclassified" data-v-2e302650>待分类</option>',5)])],40,nt)]))),128))])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 待分类图片 '),x.value.unclassifiedImages.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',at,[(0,a.createElementVNode)('h3',null,'待分类图片 ('+(0,a.toDisplayString)(x.value.unclassifiedImages.length)+')',1),t[31]||(t[31]=(0,a.createElementVNode)('p',{class:'hint'},'点击选择框将图片分类为立绘、背景、CG或纹理',-1)),(0,a.createElementVNode)('div',ot,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(x.value.unclassifiedImages,e=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e.name,class:'category-item category-item-with-select'},[(0,a.createVNode)((0,a.unref)(k),{class:'icon-sm'}),(0,a.createElementVNode)('span',lt,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)('select',{value:'',class:'classify-select',onChange:t=>function(e,t){const n=x.value.unclassifiedImages.findIndex(t=>t.name===e);if(-1===n)return void console.warn(`未找到文件: ${e}`);const a=x.value.unclassifiedImages[n];if(a){if(x.value.unclassifiedImages.splice(n,1),a.type=t,'sprite'===t){const e=a.name.match(/([^_/\\]+?)[_-]?(sprite|立绘|stand|portrait)/i);e&&e[1]&&(a.characterName=e[1])}'sprite'===t?(x.value.sprites.push(a),Gn.value.push({name:a.name,file:a.file,characterName:a.characterName,textMappings:[]})):'background'===t?(x.value.backgrounds.push(a),Hn.value.push({name:a.name,file:a.file,textMappings:[]})):'cg'===t?(x.value.cgs.push(a),Kn.value.push({name:a.name,file:a.file,textMappings:[]})):'texture'===t&&x.value.textures.push(a),l().success(`已将 "${a.name}" 分类为${'sprite'===t?'立绘':'background'===t?'背景':'cg'===t?'CG':'纹理'}`)}}(e.name,t.target.value)},[...t[30]||(t[30]=[(0,a.createStaticVNode)('<option value="" disabled data-v-2e302650>选择分类...</option><option value="sprite" data-v-2e302650>立绘</option><option value="background" data-v-2e302650>背景</option><option value="cg" data-v-2e302650>CG</option><option value="texture" data-v-2e302650>纹理</option>',5)])],40,ct)]))),128))])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 其他文件 '),x.value.others.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',st,[(0,a.createElementVNode)('h3',null,'其他文件 ('+(0,a.toDisplayString)(x.value.others.length)+')',1),(0,a.createElementVNode)('div',rt,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(x.value.others,e=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e.name,class:'category-item'},[(0,a.createVNode)((0,a.unref)(k),{class:'icon-sm'}),(0,a.createElementVNode)('span',null,(0,a.toDisplayString)(e.name),1)]))),128))])])):(0,a.createCommentVNode)('v-if',!0)])])),(0,a.createElementVNode)('div',it,[(0,a.createElementVNode)('button',{class:'bubble-btn',onClick:G},'上一步'),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-primary',disabled:!S.value,onClick:O},'下一步',8,mt)])],512),[[a.vShow,1===c.value]]),(0,a.createCommentVNode)(' 步骤3: 模型设置（可选，只在有模型时显示） '),(0,a.withDirectives)((0,a.createElementVNode)('div',ut,[B.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',dt,[(0,a.createElementVNode)('div',pt,[t[35]||(t[35]=(0,a.createElementVNode)('h3',null,'模型设置',-1)),(0,a.createElementVNode)('div',vt,[t[32]||(t[32]=(0,a.createElementVNode)('label',null,'模型名称',-1)),(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':t[5]||(t[5]=e=>f.value=e),type:'text'},null,512),[[a.vModelText,f.value]])]),(0,a.createElementVNode)('div',gt,[t[34]||(t[34]=(0,a.createElementVNode)('label',null,'模型版本',-1)),(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':t[6]||(t[6]=e=>b.value=e)},[...t[33]||(t[33]=[(0,a.createElementVNode)('option',{value:3},'3 (model3.json)',-1),(0,a.createElementVNode)('option',{value:2},'2 (model.json)',-1)])],512),[[a.vModelSelect,b.value]])])])])):((0,a.openBlock)(),(0,a.createElementBlock)('div',ft,[...t[36]||(t[36]=[(0,a.createElementVNode)('p',{class:'hint'},'未检测到模型文件，将跳过此步骤',-1)])])),(0,a.createElementVNode)('div',ht,[(0,a.createElementVNode)('button',{class:'bubble-btn',onClick:G},'上一步'),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-primary',onClick:O},(0,a.toDisplayString)(B.value?'下一步：资源设置':'下一步'),1)])],512),[[a.vShow,2===c.value]]),(0,a.createCommentVNode)(' 步骤4: 资源设置（列表界面） '),(0,a.withDirectives)((0,a.createElementVNode)('div',yt,[(0,a.createElementVNode)('div',kt,[(0,a.createCommentVNode)(' 动画和表情设置入口 '),B.value&&(w.value>0||C.value>0)?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'resource-entry-btn',onClick:t[7]||(t[7]=e=>p('animation'))},[t[38]||(t[38]=(0,a.createElementVNode)('div',{class:'resource-entry-icon'},[(0,a.createElementVNode)('svg',{class:'icon-md',fill:'none',stroke:'currentColor',viewBox:'0 0 24 24'},[(0,a.createElementVNode)('path',{'stroke-linecap':'round','stroke-linejoin':'round','stroke-width':'2',d:'M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z'}),(0,a.createElementVNode)('path',{'stroke-linecap':'round','stroke-linejoin':'round','stroke-width':'2',d:'M21 12a9 9 0 11-18 0 9 9 0 0118 0z'})])],-1)),(0,a.createElementVNode)('div',bt,[t[37]||(t[37]=(0,a.createElementVNode)('span',{class:'resource-entry-title'},'动画和表情设置',-1)),(0,a.createElementVNode)('span',Nt,(0,a.toDisplayString)(w.value)+' 个动作，'+(0,a.toDisplayString)(C.value)+' 个表情',1)]),(0,a.createElementVNode)('div',Vt,(0,a.toDisplayString)(w.value+C.value),1),t[39]||(t[39]=(0,a.createElementVNode)('svg',{class:'resource-entry-arrow',fill:'none',stroke:'currentColor',viewBox:'0 0 24 24'},[(0,a.createElementVNode)('path',{'stroke-linecap':'round','stroke-linejoin':'round','stroke-width':'2',d:'M9 5l7 7-7 7'})],-1))])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 角色立绘设置入口 '),x.value.sprites.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:1,class:'resource-entry-btn',onClick:t[8]||(t[8]=e=>p('sprite'))},[t[40]||(t[40]=(0,a.createStaticVNode)('<div class="resource-entry-icon" data-v-2e302650><svg class="icon-md" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-2e302650><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" data-v-2e302650></path></svg></div><div class="resource-entry-content" data-v-2e302650><span class="resource-entry-title" data-v-2e302650>角色立绘设置</span><span class="resource-entry-desc" data-v-2e302650>配置立绘的文本映射</span></div>',2)),(0,a.createElementVNode)('div',Et,(0,a.toDisplayString)(x.value.sprites.length),1),t[41]||(t[41]=(0,a.createElementVNode)('svg',{class:'resource-entry-arrow',fill:'none',stroke:'currentColor',viewBox:'0 0 24 24'},[(0,a.createElementVNode)('path',{'stroke-linecap':'round','stroke-linejoin':'round','stroke-width':'2',d:'M9 5l7 7-7 7'})],-1))])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 背景设置入口 '),x.value.backgrounds.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:2,class:'resource-entry-btn',onClick:t[9]||(t[9]=e=>p('background'))},[t[42]||(t[42]=(0,a.createStaticVNode)('<div class="resource-entry-icon" data-v-2e302650><svg class="icon-md" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-2e302650><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" data-v-2e302650></path></svg></div><div class="resource-entry-content" data-v-2e302650><span class="resource-entry-title" data-v-2e302650>背景设置</span><span class="resource-entry-desc" data-v-2e302650>配置背景的文本映射</span></div>',2)),(0,a.createElementVNode)('div',xt,(0,a.toDisplayString)(x.value.backgrounds.length),1),t[43]||(t[43]=(0,a.createElementVNode)('svg',{class:'resource-entry-arrow',fill:'none',stroke:'currentColor',viewBox:'0 0 24 24'},[(0,a.createElementVNode)('path',{'stroke-linecap':'round','stroke-linejoin':'round','stroke-width':'2',d:'M9 5l7 7-7 7'})],-1))])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' CG设置入口 '),x.value.cgs.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:3,class:'resource-entry-btn',onClick:t[10]||(t[10]=e=>p('cg'))},[t[44]||(t[44]=(0,a.createStaticVNode)('<div class="resource-entry-icon" data-v-2e302650><svg class="icon-md" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-2e302650><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" data-v-2e302650></path></svg></div><div class="resource-entry-content" data-v-2e302650><span class="resource-entry-title" data-v-2e302650>CG设置</span><span class="resource-entry-desc" data-v-2e302650>配置CG的文本映射</span></div>',2)),(0,a.createElementVNode)('div',Bt,(0,a.toDisplayString)(x.value.cgs.length),1),t[45]||(t[45]=(0,a.createElementVNode)('svg',{class:'resource-entry-arrow',fill:'none',stroke:'currentColor',viewBox:'0 0 24 24'},[(0,a.createElementVNode)('path',{'stroke-linecap':'round','stroke-linejoin':'round','stroke-width':'2',d:'M9 5l7 7-7 7'})],-1))])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 无可配置资源提示 '),B.value&&(w.value>0||C.value>0)||0!==x.value.sprites.length||0!==x.value.backgrounds.length||0!==x.value.cgs.length?(0,a.createCommentVNode)('v-if',!0):((0,a.openBlock)(),(0,a.createElementBlock)('div',wt,[...t[46]||(t[46]=[(0,a.createElementVNode)('p',null,'暂无可配置的资源',-1),(0,a.createElementVNode)('p',{class:'hint'},'请在上一步中上传并分类文件',-1)])]))]),(0,a.createElementVNode)('div',{class:'step-actions'},[(0,a.createElementVNode)('button',{class:'bubble-btn',onClick:G},'上一步'),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-primary',onClick:O},'下一步：完成')])],512),[[a.vShow,3===c.value&&!u.value]]),(0,a.createCommentVNode)(' 步骤4: 资源设置详情页面 '),(0,a.withDirectives)((0,a.createElementVNode)('div',Ct,[(0,a.createCommentVNode)(' 详情页内容区域（可滚动，包含头部） '),(0,a.createElementVNode)('div',$t,[(0,a.createCommentVNode)(' 详情页头部（在可滚动区域内） '),(0,a.createElementVNode)('div',Mt,[(0,a.createElementVNode)('button',{class:'back-btn',onClick:v},[...t[47]||(t[47]=[(0,a.createElementVNode)('svg',{class:'icon-sm',fill:'none',stroke:'currentColor',viewBox:'0 0 24 24'},[(0,a.createElementVNode)('path',{'stroke-linecap':'round','stroke-linejoin':'round','stroke-width':'2',d:'M15 19l-7-7 7-7'})],-1),(0,a.createTextVNode)(' 返回 ',-1)])]),(0,a.createElementVNode)('h3',St,(0,a.toDisplayString)(d.value),1)]),(0,a.createCommentVNode)(' 动画和表情设置详情 '),'animation'===u.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',Dt,[(0,a.createElementVNode)('div',_t,[t[49]||(t[49]=(0,a.createElementVNode)('label',null,'默认表情',-1)),(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':t[11]||(t[11]=e=>P.value=e),class:'select-with-scroll'},[t[48]||(t[48]=(0,a.createElementVNode)('option',{value:'none'},'无',-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(Y.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)('option',{key:e.name,value:e.name},(0,a.toDisplayString)(e.name),9,jt))),128))],512),[[a.vModelSelect,P.value]])]),(0,a.createElementVNode)('div',Lt,[t[51]||(t[51]=(0,a.createElementVNode)('label',null,'默认动作（Idle）',-1)),(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':t[12]||(t[12]=e=>q.value=e),class:'select-with-scroll'},[t[50]||(t[50]=(0,a.createElementVNode)('option',{value:'none'},'无',-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(X.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)('option',{key:e.name,value:e.name},(0,a.toDisplayString)(e.name),9,Tt))),128))],512),[[a.vModelSelect,q.value]])]),(0,a.createElementVNode)('div',Ut,[(0,a.createElementVNode)('label',null,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':t[13]||(t[13]=e=>J.value=e),type:'checkbox'},null,512),[[a.vModelCheckbox,J.value]]),t[52]||(t[52]=(0,a.createTextVNode)(' 自动循环默认动作 ',-1))]),t[53]||(t[53]=(0,a.createElementVNode)('p',{class:'hint'},'当没有检测到特定文本时，将自动循环播放默认动作',-1))]),(0,a.createCommentVNode)(' 文本到动作/表情映射 '),(0,a.createElementVNode)('div',It,[(0,a.createElementVNode)('div',Rt,[t[55]||(t[55]=(0,a.createElementVNode)('h4',null,'文本映射',-1)),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-sm add-mapping-btn',onClick:ne},[(0,a.createVNode)((0,a.unref)(W),{class:'icon-sm'}),t[54]||(t[54]=(0,a.createTextVNode)(' 添加映射 ',-1))])]),t[61]||(t[61]=(0,a.createElementVNode)('p',{class:'hint'},'当检测到特定文本时，自动播放对应的动作和表情（多个文本用分号分隔）',-1)),(0,a.createElementVNode)('div',Ft,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(Q.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:n,class:'mapping-item'},[(0,a.createElementVNode)('div',At,[(0,a.createElementVNode)('div',Ot,[t[56]||(t[56]=(0,a.createElementVNode)('label',{class:'mapping-label'},'触发文本',-1)),(0,a.createElementVNode)('input',{value:e.text,type:'text',placeholder:'输入触发文本，多个用分号(;)分隔',class:'mapping-text-input tags-input',onBlur:e=>function(e,t){const n=ae(t.target.value.trim());Q.value[e].text=n.join(';'),Q.value[e].textTags=n}(n,e),onKeydown:(0,a.withKeys)(e=>{return(t=e).preventDefault(),void t.target.blur();var t},['enter'])},null,40,zt),e.textTags&&e.textTags.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',Wt,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.textTags,(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('span',{key:t,class:'text-tag'},[(0,a.createTextVNode)((0,a.toDisplayString)(e)+' ',1),(0,a.createElementVNode)('button',{class:'tag-remove',onClick:e=>function(e,t){Q.value[e].textTags&&(Q.value[e].textTags.splice(t,1),Q.value[e].text=Q.value[e].textTags.join(';'))}(n,t)},'×',8,Gt)]))),128))])):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createElementVNode)('div',Ht,[(0,a.createElementVNode)('div',Kt,[t[58]||(t[58]=(0,a.createElementVNode)('label',{class:'mapping-label'},'表情',-1)),(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':t=>e.expression=t,class:'mapping-select select-with-scroll'},[t[57]||(t[57]=(0,a.createElementVNode)('option',{value:'none'},'无表情',-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(Y.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)('option',{key:e.name,value:e.name},(0,a.toDisplayString)(e.name),9,qt))),128))],8,Pt),[[a.vModelSelect,e.expression]])]),(0,a.createElementVNode)('div',Jt,[t[60]||(t[60]=(0,a.createElementVNode)('label',{class:'mapping-label'},'动作',-1)),(0,a.withDirectives)((0,a.createElementVNode)('select',{'onUpdate:modelValue':t=>e.motion=t,class:'mapping-select select-with-scroll'},[t[59]||(t[59]=(0,a.createElementVNode)('option',{value:'none'},'无动作',-1)),((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(X.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)('option',{key:e.name,value:e.name},(0,a.toDisplayString)(e.name),9,Xt))),128))],8,Qt),[[a.vModelSelect,e.motion]])]),(0,a.createElementVNode)('button',{class:'remove-mapping-btn',title:'删除',onClick:e=>function(e){Q.value.splice(e,1)}(n)},[(0,a.createVNode)((0,a.unref)(M),{class:'icon-sm'})],8,Yt)])])]))),128))])])])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 角色立绘设置详情 '),'sprite'===u.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',Zt,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(Gn.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:n,class:'sprite-item'},[(0,a.createElementVNode)('div',en,[(0,a.createElementVNode)('span',tn,(0,a.toDisplayString)(e.name),1),e.characterName?((0,a.openBlock)(),(0,a.createElementBlock)('span',nn,(0,a.toDisplayString)(e.characterName),1)):(0,a.createCommentVNode)('v-if',!0),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-sm add-mapping-btn-inline',onClick:e=>function(e){Gn.value[e].textMappings||(Gn.value[e].textMappings=[]),Gn.value[e].textMappings.push({text:'',textTags:[]})}(n)},[(0,a.createVNode)((0,a.unref)(W),{class:'icon-sm'}),t[62]||(t[62]=(0,a.createTextVNode)(' 添加映射 ',-1))],8,an)]),(0,a.createElementVNode)('div',on,[(0,a.createElementVNode)('div',ln,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.textMappings||[],(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:t,class:'mapping-item'},[(0,a.createElementVNode)('div',cn,[(0,a.createElementVNode)('div',sn,[(0,a.createElementVNode)('input',{value:e.text,type:'text',placeholder:'输入触发文本，多个用分号(;)分隔',class:'mapping-text-input tags-input',onBlur:e=>function(e,t,n){const a=ae(n.target.value.trim());Gn.value[e].textMappings&&(Gn.value[e].textMappings[t].text=a.join(';'),Gn.value[e].textMappings[t].textTags=a)}(n,t,e),onKeydown:(0,a.withKeys)(e=>{return(t=e).preventDefault(),void t.target.blur();var t},['enter'])},null,40,rn),e.textTags&&e.textTags.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',mn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.textTags,(e,o)=>((0,a.openBlock)(),(0,a.createElementBlock)('span',{key:o,class:'text-tag'},[(0,a.createTextVNode)((0,a.toDisplayString)(e)+' ',1),(0,a.createElementVNode)('button',{class:'tag-remove',onClick:e=>function(e,t,n){Gn.value[e].textMappings?.[t].textTags&&(Gn.value[e].textMappings[t].textTags.splice(n,1),Gn.value[e].textMappings[t].text=Gn.value[e].textMappings[t].textTags.join(';'))}(n,t,o)},'×',8,un)]))),128))])):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createElementVNode)('button',{class:'remove-mapping-btn',title:'删除',onClick:e=>{return a=n,o=t,void(Gn.value[a].textMappings&&Gn.value[a].textMappings.splice(o,1));var a,o}},[(0,a.createVNode)((0,a.unref)(M),{class:'icon-sm'})],8,dn)])]))),128))])])]))),128))])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' 背景设置详情 '),'background'===u.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',pn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(Hn.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:n,class:'background-item'},[(0,a.createElementVNode)('div',vn,[(0,a.createElementVNode)('span',gn,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-sm add-mapping-btn-inline',onClick:e=>function(e){Hn.value[e].textMappings||(Hn.value[e].textMappings=[]),Hn.value[e].textMappings.push({text:'',textTags:[]})}(n)},[(0,a.createVNode)((0,a.unref)(W),{class:'icon-sm'}),t[63]||(t[63]=(0,a.createTextVNode)(' 添加映射 ',-1))],8,fn)]),(0,a.createElementVNode)('div',hn,[(0,a.createElementVNode)('div',yn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.textMappings||[],(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:t,class:'mapping-item'},[(0,a.createElementVNode)('div',kn,[(0,a.createElementVNode)('div',bn,[(0,a.createElementVNode)('input',{value:e.text,type:'text',placeholder:'输入触发文本，多个用分号(;)分隔',class:'mapping-text-input tags-input',onBlur:e=>function(e,t,n){const a=ae(n.target.value.trim());Hn.value[e].textMappings&&(Hn.value[e].textMappings[t].text=a.join(';'),Hn.value[e].textMappings[t].textTags=a)}(n,t,e),onKeydown:(0,a.withKeys)(e=>{return(t=e).preventDefault(),void t.target.blur();var t},['enter'])},null,40,Nn),e.textTags&&e.textTags.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',Vn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.textTags,(e,o)=>((0,a.openBlock)(),(0,a.createElementBlock)('span',{key:o,class:'text-tag'},[(0,a.createTextVNode)((0,a.toDisplayString)(e)+' ',1),(0,a.createElementVNode)('button',{class:'tag-remove',onClick:e=>function(e,t,n){Hn.value[e].textMappings?.[t].textTags&&(Hn.value[e].textMappings[t].textTags.splice(n,1),Hn.value[e].textMappings[t].text=Hn.value[e].textMappings[t].textTags.join(';'))}(n,t,o)},' × ',8,En)]))),128))])):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createElementVNode)('button',{class:'remove-mapping-btn',title:'删除',onClick:e=>{return a=n,o=t,void(Hn.value[a].textMappings&&Hn.value[a].textMappings.splice(o,1));var a,o}},[(0,a.createVNode)((0,a.unref)(M),{class:'icon-sm'})],8,xn)])]))),128))])])]))),128))])):(0,a.createCommentVNode)('v-if',!0),(0,a.createCommentVNode)(' CG设置详情 '),'cg'===u.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',Bn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(Kn.value,(e,n)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:n,class:'cg-item'},[(0,a.createElementVNode)('div',wn,[(0,a.createElementVNode)('span',Cn,(0,a.toDisplayString)(e.name),1),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-sm add-mapping-btn-inline',onClick:e=>function(e){Kn.value[e].textMappings||(Kn.value[e].textMappings=[]),Kn.value[e].textMappings.push({text:'',textTags:[]})}(n)},[(0,a.createVNode)((0,a.unref)(W),{class:'icon-sm'}),t[64]||(t[64]=(0,a.createTextVNode)(' 添加映射 ',-1))],8,$n)]),(0,a.createElementVNode)('div',Mn,[(0,a.createElementVNode)('div',Sn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.textMappings||[],(e,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:t,class:'mapping-item'},[(0,a.createElementVNode)('div',Dn,[(0,a.createElementVNode)('div',_n,[(0,a.createElementVNode)('input',{value:e.text,type:'text',placeholder:'输入触发文本，多个用分号(;)分隔',class:'mapping-text-input tags-input',onBlur:e=>function(e,t,n){const a=ae(n.target.value.trim());Kn.value[e].textMappings&&(Kn.value[e].textMappings[t].text=a.join(';'),Kn.value[e].textMappings[t].textTags=a)}(n,t,e),onKeydown:(0,a.withKeys)(e=>{return(t=e).preventDefault(),void t.target.blur();var t},['enter'])},null,40,jn),e.textTags&&e.textTags.length>0?((0,a.openBlock)(),(0,a.createElementBlock)('div',Ln,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.textTags,(e,o)=>((0,a.openBlock)(),(0,a.createElementBlock)('span',{key:o,class:'text-tag'},[(0,a.createTextVNode)((0,a.toDisplayString)(e)+' ',1),(0,a.createElementVNode)('button',{class:'tag-remove',onClick:e=>function(e,t,n){Kn.value[e].textMappings?.[t].textTags&&(Kn.value[e].textMappings[t].textTags.splice(n,1),Kn.value[e].textMappings[t].text=Kn.value[e].textMappings[t].textTags.join(';'))}(n,t,o)},'×',8,Tn)]))),128))])):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createElementVNode)('button',{class:'remove-mapping-btn',title:'删除',onClick:e=>{return a=n,o=t,void(Kn.value[a].textMappings&&Kn.value[a].textMappings.splice(o,1));var a,o}},[(0,a.createVNode)((0,a.unref)(M),{class:'icon-sm'})],8,Un)])]))),128))])])]))),128))])):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createCommentVNode)(' 详情页底部操作 '),(0,a.createElementVNode)('div',{class:'step-actions'},[(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-primary',onClick:v},'完成设置')])],512),[[a.vShow,3===c.value&&u.value]]),(0,a.createCommentVNode)(' 步骤5: 完成 '),(0,a.withDirectives)((0,a.createElementVNode)('div',In,[(0,a.createElementVNode)('div',Rn,[(0,a.createVNode)((0,a.unref)(k),{class:'icon-lg success-icon'}),t[65]||(t[65]=(0,a.createElementVNode)('h2',null,'准备完成',-1)),(0,a.createElementVNode)('p',null,'模型 "'+(0,a.toDisplayString)(f.value)+'" 已准备就绪',1),(0,a.createElementVNode)('div',Fn,[(0,a.createElementVNode)('p',null,'模型文件: '+(0,a.toDisplayString)(B.value?'✓':'✗'),1),(0,a.createElementVNode)('p',null,'纹理文件: '+(0,a.toDisplayString)(x.value.textures.length)+' 个',1),(0,a.createElementVNode)('p',null,'动作文件: '+(0,a.toDisplayString)(w.value)+' 个',1),(0,a.createElementVNode)('p',null,'表情文件: '+(0,a.toDisplayString)(C.value)+' 个',1)])]),(0,a.createElementVNode)('div',An,[(0,a.createElementVNode)('button',{class:'bubble-btn',onClick:G},'上一步'),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-primary',disabled:y.value,onClick:Pn},[y.value?((0,a.openBlock)(),(0,a.createElementBlock)('span',zn,'正在创建...')):((0,a.openBlock)(),(0,a.createElementBlock)('span',Wn,'完成并创建世界书条目'))],8,On)])],512),[[a.vShow,4===c.value]])]))}}),Hn=(0,v.A)(Gn,[['__scopeId','data-v-2e302650']]),Kn={class:'opening-interface-wrapper'},Pn={class:'opening-interface'},qn={class:'page main-menu'},Jn={class:'menu-buttons'},Qn={class:'page start-game'},Xn={class:'openings-grid'},Yn=['onClick'],Zn={class:'image-wrapper'},ea=['src','alt'],ta={class:'content'},na={class:'hover-icon'},aa={class:'page settings'},oa={class:'page character-intro'},la={class:'character-display'},ca={class:'character-card-inner'},sa={class:'character-image'},ra=['src','alt'],ia={class:'character-info'},ma={class:'character-role'},ua={class:'character-name'},da={class:'character-desc'},pa={class:'character-dots'},va=['onClick'],ga=(0,a.defineComponent)({__name:'app',setup(e){const{currentPage:t,showPage:n}=function(){const e=(0,a.ref)('main-menu');return{currentPage:e,showPage:function(t){e.value=t}}}(),o=(0,a.ref)(c),r=(0,a.ref)(s),{currentIndex:i,currentItem:m,prev:p,next:v,goTo:g}=function(e){const t=(0,a.ref)(0),n=(0,a.computed)(()=>e[t.value]);return{currentIndex:t,currentItem:n,prev:function(){t.value=0===t.value?e.length-1:t.value-1},next:function(){t.value=t.value===e.length-1?0:t.value+1},goTo:function(n){n>=0&&n<e.length&&(t.value=n)}}}(r.value),f=(0,a.ref)();async function h(e){await async function(e){try{await createChatMessages([{role:'system',message:e.message}],{refresh:'all'}),await triggerSlash('/trigger'),l().success(`已选择开场：${e.title}`)}catch(e){throw console.error('选择开场失败:',e),l().error('选择开场失败'),e}}(e)}function y(){}return(0,a.onMounted)(()=>{(0,a.nextTick)(()=>{!function(e){if(!e)return;const{count:t,minDuration:n,maxDuration:a,maxDelay:o}=u;for(let l=0;l<t;l++){const t=document.createElement('div');t.className='particle',t.style.left=100*Math.random()+'%',t.style.top=100*Math.random()+'%',t.style.animationDelay=Math.random()*o+'s',t.style.animationDuration=`${n+Math.random()*(a-n)}s`,e.appendChild(t)}}(f.value),d()})}),(0,a.watch)(t,()=>{(0,a.nextTick)(()=>{const e=window.__applyScale;e&&e(),d()})}),(e,l)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',Kn,[(0,a.createElementVNode)('div',Pn,[(0,a.createCommentVNode)(' 背景 '),l[15]||(l[15]=(0,a.createElementVNode)('div',{class:'background'},null,-1)),l[16]||(l[16]=(0,a.createElementVNode)('div',{class:'overlay'},null,-1)),(0,a.createCommentVNode)(' 粒子效果 '),(0,a.createElementVNode)('div',{ref_key:'particlesRef',ref:f,class:'particles'},null,512),(0,a.createCommentVNode)(' 主菜单 '),(0,a.withDirectives)((0,a.createElementVNode)('div',qn,[l[11]||(l[11]=(0,a.createElementVNode)('div',{class:'title-section'},[(0,a.createElementVNode)('h1',null,'星之轨迹'),(0,a.createElementVNode)('p',{class:'subtitle'},'Starlight Trail'),(0,a.createElementVNode)('p',{class:'tagline'},'— 一段跨越时空的浪漫物语 —')],-1)),(0,a.createElementVNode)('div',Jn,[(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-lg',onClick:l[0]||(l[0]=e=>(0,a.unref)(n)('start-game'))},[(0,a.createVNode)((0,a.unref)(j)),l[8]||(l[8]=(0,a.createTextVNode)(' 开始游戏 ',-1))]),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-lg',onClick:l[1]||(l[1]=e=>(0,a.unref)(n)('settings'))},[(0,a.createVNode)((0,a.unref)(U)),l[9]||(l[9]=(0,a.createTextVNode)(' 游戏设置 ',-1))]),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-lg',onClick:l[2]||(l[2]=e=>(0,a.unref)(n)('character-intro'))},[(0,a.createVNode)((0,a.unref)(K)),l[10]||(l[10]=(0,a.createTextVNode)(' 角色介绍 ',-1))])]),l[12]||(l[12]=(0,a.createElementVNode)('div',{class:'footer'},[(0,a.createElementVNode)('p',null,'© 2025 Per Aspera Ad Astra. By sixue')],-1))],512),[[a.vShow,'main-menu'===(0,a.unref)(t)]]),(0,a.createCommentVNode)(' 开始游戏页面 '),(0,a.withDirectives)((0,a.createElementVNode)('div',Qn,[(0,a.createVNode)((0,a.unref)(oe),{title:'选择开场',onBack:l[3]||(l[3]=e=>(0,a.unref)(n)('main-menu'))},{default:(0,a.withCtx)(()=>[(0,a.createVNode)((0,a.unref)(F))]),_:1}),(0,a.createElementVNode)('div',Xn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(o.value,e=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e.id,class:'opening-card',onClick:t=>h(e)},[(0,a.createElementVNode)('div',Zn,[(0,a.createElementVNode)('img',{src:e.image||'',alt:e.title},null,8,ea)]),(0,a.createElementVNode)('div',ta,[(0,a.createElementVNode)('h3',null,(0,a.toDisplayString)(e.title),1),(0,a.createElementVNode)('p',null,(0,a.toDisplayString)(e.description),1)]),(0,a.createElementVNode)('div',na,[(0,a.createVNode)((0,a.unref)(F),{class:'icon-sm'})])],8,Yn))),128))]),l[13]||(l[13]=(0,a.createElementVNode)('p',{class:'hint-text'},'选择一个开场，开启你的专属故事',-1))],512),[[a.vShow,'start-game'===(0,a.unref)(t)]]),(0,a.createCommentVNode)(' 设置页面（整合了上传向导） '),(0,a.withDirectives)((0,a.createElementVNode)('div',aa,[(0,a.createVNode)((0,a.unref)(Hn),{onClose:l[4]||(l[4]=e=>(0,a.unref)(n)('main-menu')),onComplete:y})],512),[[a.vShow,'settings'===(0,a.unref)(t)]]),(0,a.createCommentVNode)(' 角色介绍页面 '),(0,a.withDirectives)((0,a.createElementVNode)('div',oa,[(0,a.createVNode)((0,a.unref)(oe),{title:'角色介绍',onBack:l[5]||(l[5]=e=>(0,a.unref)(n)('main-menu'))}),(0,a.createElementVNode)('div',la,[(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-round nav-btn',onClick:l[6]||(l[6]=(...e)=>(0,a.unref)(p)&&(0,a.unref)(p)(...e))},[(0,a.createVNode)((0,a.unref)(V),{class:'icon-lg'})]),(0,a.createElementVNode)('div',{class:(0,a.normalizeClass)(['character-card',(0,a.unref)(m).colorClass])},[(0,a.createElementVNode)('div',ca,[(0,a.createElementVNode)('div',sa,[(0,a.createElementVNode)('img',{src:(0,a.unref)(m).image||'',alt:(0,a.unref)(m).name},null,8,ra)]),(0,a.createElementVNode)('div',ia,[(0,a.createElementVNode)('span',ma,(0,a.toDisplayString)((0,a.unref)(m).role),1),(0,a.createElementVNode)('h3',ua,(0,a.toDisplayString)((0,a.unref)(m).name),1),(0,a.createElementVNode)('p',da,(0,a.toDisplayString)((0,a.unref)(m).desc),1),(0,a.createElementVNode)('div',pa,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(r.value,(_,e)=>((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:e,class:(0,a.normalizeClass)(['dot',{active:e===(0,a.unref)(i)}]),onClick:t=>(0,a.unref)(g)(e)},null,10,va))),128))])])])],2),(0,a.createElementVNode)('button',{class:'bubble-btn bubble-btn-round nav-btn',onClick:l[7]||(l[7]=(...e)=>(0,a.unref)(v)&&(0,a.unref)(v)(...e))},[(0,a.createVNode)((0,a.unref)(B),{class:'icon-lg'})])]),l[14]||(l[14]=(0,a.createElementVNode)('p',{class:'hint-text'},'点击左右按钮或底部指示器切换角色',-1))],512),[[a.vShow,'character-intro'===(0,a.unref)(t)]])])]))}}),fa=(0,v.A)(ga,[['__scopeId','data-v-dffb8c58']]);function ha(){const e=document.querySelector('.opening-interface');if(!e)return;if(e.querySelector('.main-menu')){e.classList.add('main-menu-active');const t=1200,n=800,a=window.innerWidth,o=window.innerHeight,l=20,c=Math.max(a-2*l,0),s=Math.max(o-2*l,0);if(c<=0||s<=0)return;const r=c/t,i=s/n,m=Math.min(r,i,1);e.style.transform=`scale(${m})`,e.style.transformOrigin='top center',console.info(`[开场界面] 主菜单应用缩放比例: ${m.toFixed(3)} (容器: ${a}x${o})`)}else e.classList.remove('main-menu-active'),e.style.transform='',e.style.transformOrigin='',console.info('[开场界面] 其他页面，移除缩放限制')}$(()=>{try{console.info('[开场界面] 开始初始化...');if(!document.getElementById('app'))throw new Error('找不到 #app 元素');console.info('[开场界面] 创建 Vue 应用实例...');const e=(0,a.createApp)(fa);console.info('[开场界面] 挂载到 #app...'),e.mount('#app'),console.info('[开场界面] Vue 应用挂载成功，初始化缩放和自适应高度...'),window.__applyScale=ha,setTimeout(()=>{!function(){let e;ha();const t=()=>{clearTimeout(e),e=setTimeout(()=>{ha(),d()},100)};window.addEventListener('resize',t),window.__cleanupOpeningInterface=function(){window.removeEventListener('resize',t),n&&'undefined'!=typeof ResizeObserver&&new ResizeObserver(()=>{}).disconnect()};const n=document.querySelector('.opening-interface-wrapper');if(n&&'undefined'!=typeof ResizeObserver){const e=new ResizeObserver(()=>{ha(),d()});e.observe(n);const t=document.querySelector('.opening-interface');t&&e.observe(t)}setTimeout(()=>{ha(),d()},100),setTimeout(()=>{ha(),d()},300),setTimeout(()=>{ha(),d()},500),setTimeout(()=>{ha(),d()},1e3)}(),function(){if(d(),'undefined'!=typeof ResizeObserver){const e=new ResizeObserver(()=>{clearTimeout(window.__heightAdjustTimeout),window.__heightAdjustTimeout=setTimeout(()=>{d()},100)}),t=document.getElementById('app');t&&e.observe(t),e.observe(document.body),e.observe(document.documentElement),window.addEventListener('resize',()=>{d()}),console.info('[开场界面] 已启用 ResizeObserver 自动高度调整')}else new MutationObserver(()=>{d()}).observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:['style','class']}),setInterval(()=>{d()},500),console.info('[开场界面] 已启用 MutationObserver 自动高度调整（降级方案）');setTimeout(()=>{d()},100),setTimeout(()=>{d()},500),setTimeout(()=>{d()},1e3)}()},100),console.info('[开场界面] 初始化成功！')}catch(e){console.error('[开场界面] 初始化失败:',e);const t=document.getElementById('app');t&&(t.innerHTML=`\n        <div style="padding: 20px; color: red; background: white; font-family: monospace;">\n          <h2>❌ 开场界面初始化错误</h2>\n          <p><strong>错误信息:</strong></p>\n          <pre style="background: #f5f5f5; padding: 10px; border-radius: 4px; overflow: auto;">${e instanceof Error?e.message:String(e)}</pre>\n          ${e instanceof Error&&e.stack?`<p><strong>堆栈跟踪:</strong></p><pre style="background: #f5f5f5; padding: 10px; border-radius: 4px; overflow: auto; font-size: 12px;">${e.stack}</pre>`:''}\n        </div>\n      `)}}),$(window).on('pagehide',()=>{window.__cleanupOpeningInterface&&window.__cleanupOpeningInterface(),console.info('[开场界面] 资源清理完成')});
//# sourceMappingURL=index.js.map</script><style>.collapsible-section[data-v-379bada6]{background:hsla(0,0%,100%,.6);border-radius:12px;overflow:hidden;backdrop-filter:blur(10px)}.collapsible-header[data-v-379bada6]{width:100%;display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:rgba(0,0,0,0);border:none;cursor:pointer;transition:all .3s;text-align:left}.collapsible-header[data-v-379bada6]:hover{background:rgba(0,0,0,.05)}.collapsible-header.expanded[data-v-379bada6]{border-bottom:1px solid rgba(0,0,0,.1)}.header-title[data-v-379bada6]{display:flex;align-items:center;gap:8px;font-size:16px;font-weight:600;color:var(--foreground)}.badge[data-v-379bada6]{padding:2px 8px;background:rgba(236,72,153,.2);color:var(--primary-color,#ec4899);border-radius:12px;font-size:12px;font-weight:500}.chevron-icon[data-v-379bada6]{width:20px;height:20px;transition:transform .3s;color:var(--muted-foreground)}.chevron-icon.rotated[data-v-379bada6]{transform:rotate(180deg)}.collapsible-content[data-v-379bada6]{padding:16px;animation:slideDown-379bada6 .3s ease-out;overflow:visible;max-height:none}@keyframes slideDown-379bada6{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.slide-enter-active[data-v-379bada6],.slide-leave-active[data-v-379bada6]{transition:all .3s ease;overflow:hidden}.slide-enter-from[data-v-379bada6],.slide-leave-to[data-v-379bada6]{max-height:0;opacity:0;padding-top:0;padding-bottom:0}.slide-enter-to[data-v-379bada6],.slide-leave-from[data-v-379bada6]{max-height:2000px;opacity:1}
.model-upload-wizard[data-v-2e302650]{width:100%;max-width:800px;margin:0 auto;height:100%;display:flex;flex-direction:column;overflow:hidden}.steps-indicator[data-v-2e302650]{display:flex;justify-content:space-between;margin:16px 0;padding:0 20px;flex-shrink:0}.step-item[data-v-2e302650]{flex:1;display:flex;flex-direction:column;align-items:center;position:relative}.step-item[data-v-2e302650]::after{content:"";position:absolute;top:20px;left:50%;width:100%;height:2px;background:rgba(0,0,0,.1);z-index:-1}.step-item[data-v-2e302650]:last-child::after{display:none}.step-item.active .step-number[data-v-2e302650]{background:var(--primary-color,#ec4899);color:#fff}.step-item.completed .step-number[data-v-2e302650]{background:#10b981;color:#fff}.step-number[data-v-2e302650]{width:40px;height:40px;border-radius:50%;background:rgba(0,0,0,.1);display:flex;align-items:center;justify-content:center;font-weight:bold;margin-bottom:8px}.step-label[data-v-2e302650]{font-size:14px;color:var(--muted-foreground)}.step-content[data-v-2e302650]{flex:1;display:flex;flex-direction:column;overflow:hidden;padding:16px;min-height:0}.step-content[data-v-2e302650]>*:not(.step-actions){flex:1;overflow-y:auto;overflow-x:hidden;min-height:0;scrollbar-width:none;-ms-overflow-style:none}.step-content[data-v-2e302650]>*:not(.step-actions)::-webkit-scrollbar{display:none}.step-content .step-actions[data-v-2e302650]{flex-shrink:0;margin-top:auto;padding-top:16px}.upload-area[data-v-2e302650]{border:2px dashed rgba(0,0,0,.2);border-radius:12px;padding:40px;text-align:center;cursor:pointer;transition:all .3s;min-height:300px;display:flex;flex-direction:column;justify-content:center}.upload-area[data-v-2e302650]:hover{border-color:var(--primary-color,#ec4899);background:rgba(236,72,153,.05)}.upload-area-inner[data-v-2e302650]{width:100%;height:100%}.upload-area-inner[data-v-2e302650]{width:100%;height:100%}.upload-placeholder[data-v-2e302650]{display:flex;flex-direction:column;align-items:center;gap:16px}.uploaded-files-preview[data-v-2e302650]{width:100%;cursor:default}.uploaded-files-preview[data-v-2e302650] *{pointer-events:auto}.files-summary[data-v-2e302650]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:12px}.summary-actions[data-v-2e302650]{display:flex;gap:8px}.files-list[data-v-2e302650]{display:flex;flex-direction:column;gap:8px;max-height:200px;overflow-y:auto;overflow-x:hidden;scrollbar-width:none;-ms-overflow-style:none}.files-list[data-v-2e302650]::-webkit-scrollbar{display:none}.file-item[data-v-2e302650]{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:8px 12px;background:rgba(0,0,0,.05);border-radius:8px;transition:background .2s}.file-item[data-v-2e302650]:hover{background:rgba(0,0,0,.1)}.file-name[data-v-2e302650]{flex:1;text-align:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.remove-file-btn[data-v-2e302650]{display:flex;align-items:center;justify-content:center;width:24px;height:24px;padding:0;border:none;background:rgba(239,68,68,.1);color:#ef4444;border-radius:4px;cursor:pointer;transition:all .2s}.remove-file-btn[data-v-2e302650]:hover{background:rgba(239,68,68,.2)}.file-source-badge[data-v-2e302650]{padding:2px 6px;border-radius:4px;font-size:11px;font-weight:500;background:rgba(59,130,246,.1);color:#3b82f6}.file-type-badge[data-v-2e302650]{padding:4px 8px;border-radius:4px;font-size:12px;font-weight:500}.file-type-badge.type-texture[data-v-2e302650]{background:#e0f2fe;color:#0369a1}.file-type-badge.type-moc3[data-v-2e302650],.file-type-badge.type-model3[data-v-2e302650]{background:#fef3c7;color:#92400e}.file-type-badge.type-motion[data-v-2e302650]{background:#dbeafe;color:#1e40af}.file-type-badge.type-image[data-v-2e302650]{background:#fce7f3;color:#9f1239}.file-type-badge.type-other[data-v-2e302650]{background:#f3f4f6;color:#6b7280}.classifying-status[data-v-2e302650]{text-align:center;padding:20px}.classified-files[data-v-2e302650]{display:flex;flex-direction:column;gap:16px;overflow-y:auto;overflow-x:hidden;scrollbar-width:none;-ms-overflow-style:none}.classified-files[data-v-2e302650]::-webkit-scrollbar{display:none}.settings-card[data-v-2e302650]{background:hsla(0,0%,100%,.6);border-radius:12px;padding:16px;backdrop-filter:blur(10px)}.model-name-input[data-v-2e302650]{width:100%;padding:12px;border:1px solid rgba(0,0,0,.2);border-radius:8px;font-size:16px;margin-top:8px}.files-categories[data-v-2e302650]{display:flex;flex-direction:column;gap:12px}.category-section[data-v-2e302650]{background:hsla(0,0%,100%,.6);border-radius:12px;padding:16px;backdrop-filter:blur(10px)}.file-category[data-v-2e302650]{display:flex;flex-direction:column;gap:8px;margin-top:12px;max-height:300px;overflow-y:auto;overflow-x:hidden;scrollbar-width:none;-ms-overflow-style:none}.file-category[data-v-2e302650]::-webkit-scrollbar{display:none}.category-item[data-v-2e302650]{display:flex;align-items:center;gap:8px;padding:8px;background:rgba(0,0,0,.05);border-radius:8px}.toggle-type-btn[data-v-2e302650]{margin-left:auto;padding:4px 8px;font-size:12px;background:rgba(0,0,0,.1);border:none;border-radius:4px;cursor:pointer}.step-actions[data-v-2e302650]{display:flex;justify-content:space-between;gap:16px;margin-top:16px;padding-top:16px;border-top:1px solid rgba(0,0,0,.1);flex-shrink:0}.character-name-badge[data-v-2e302650]{padding:2px 8px;background:rgba(99,102,241,.2);color:#6366f1;border-radius:12px;font-size:12px;font-weight:500;margin-left:auto}.upload-methods-container[data-v-2e302650]{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-top:24px}@media (max-width:768px){.upload-methods-container[data-v-2e302650]{grid-template-columns:1fr}}.upload-method-section[data-v-2e302650]{display:flex;flex-direction:column;gap:12px}.method-title[data-v-2e302650]{font-size:16px;font-weight:600;margin:0;color:var(--foreground)}.url-upload-area[data-v-2e302650]{display:flex;flex-direction:column;gap:16px}.url-input-group[data-v-2e302650]{display:flex;gap:12px;align-items:stretch}.url-input[data-v-2e302650]{flex:1;padding:12px;border:1px solid rgba(0,0,0,.2);border-radius:8px;font-size:14px;background:#fff}.category-item-with-select[data-v-2e302650]{padding:12px}.classify-select[data-v-2e302650]{margin-left:auto;min-width:140px;padding:8px 12px;border:1px solid rgba(0,0,0,.2);border-radius:8px;font-size:14px;background:#fff;cursor:pointer;transition:all .2s}.classify-select[data-v-2e302650]:hover{border-color:rgba(0,0,0,.3)}.classify-select[data-v-2e302650]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 3px rgba(99,102,241,.1)}.completion-summary[data-v-2e302650]{text-align:center;padding:40px}.success-icon[data-v-2e302650]{width:64px;height:64px;color:#10b981;margin-bottom:16px}.summary-details[data-v-2e302650]{margin-top:24px;display:flex;flex-direction:column;gap:8px;text-align:left;max-width:300px;margin-left:auto;margin-right:auto}.hidden-input[data-v-2e302650]{display:none}.resource-settings-list[data-v-2e302650]{display:flex;flex-direction:column;gap:12px;overflow-y:auto;overflow-x:hidden;flex:1;scrollbar-width:none;-ms-overflow-style:none}.resource-settings-list[data-v-2e302650]::-webkit-scrollbar{display:none}.resource-entry-btn[data-v-2e302650]{display:flex;align-items:center;gap:16px;width:100%;padding:16px 20px;background:hsla(0,0%,100%,.6);border:1px solid rgba(0,0,0,.1);border-radius:12px;cursor:pointer;transition:all .2s;text-align:left;backdrop-filter:blur(10px)}.resource-entry-btn[data-v-2e302650]:hover{background:hsla(0,0%,100%,.8);border-color:var(--primary-color,#ec4899);transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.1)}.resource-entry-btn[data-v-2e302650]:active{transform:translateY(0)}.resource-entry-icon[data-v-2e302650]{width:48px;height:48px;display:flex;align-items:center;justify-content:center;background:rgba(236,72,153,.1);border-radius:12px;color:var(--primary-color,#ec4899);flex-shrink:0}.resource-entry-content[data-v-2e302650]{flex:1;display:flex;flex-direction:column;gap:4px;min-width:0}.resource-entry-title[data-v-2e302650]{font-size:16px;font-weight:600;color:var(--foreground)}.resource-entry-desc[data-v-2e302650]{font-size:13px;color:var(--muted-foreground)}.resource-entry-badge[data-v-2e302650]{padding:4px 12px;background:var(--primary-color,#ec4899);color:#fff;border-radius:20px;font-size:13px;font-weight:600;flex-shrink:0}.resource-entry-arrow[data-v-2e302650]{width:20px;height:20px;color:var(--muted-foreground);flex-shrink:0}.no-resources-hint[data-v-2e302650]{text-align:center;padding:40px 20px;color:var(--muted-foreground)}.no-resources-hint p[data-v-2e302650]{margin:8px 0}.resource-detail-page[data-v-2e302650]{display:flex;flex-direction:column;height:100%}.resource-detail-content[data-v-2e302650]{flex:1;overflow-y:auto;overflow-x:hidden;padding:0 4px 0 0;min-height:0;scrollbar-width:none;-ms-overflow-style:none}.resource-detail-content[data-v-2e302650]::-webkit-scrollbar{display:none}.resource-detail-header[data-v-2e302650]{display:flex;align-items:center;gap:12px;padding:12px 16px;margin-bottom:16px;flex-shrink:0;position:sticky;top:0;background:hsla(0,0%,100%,.7);backdrop-filter:blur(8px);border:1px solid rgba(0,0,0,.08);border-radius:8px;z-index:10}.back-btn[data-v-2e302650]{display:flex;align-items:center;gap:4px;padding:8px 12px;background:rgba(0,0,0,.05);border:none;border-radius:8px;cursor:pointer;font-size:14px;color:var(--foreground);transition:all .2s;flex-shrink:0}.back-btn[data-v-2e302650]:hover{background:rgba(0,0,0,.1)}.resource-detail-title[data-v-2e302650]{font-size:18px;font-weight:600;margin:0;color:var(--foreground)}.mapping-inputs-vertical[data-v-2e302650]{display:flex;flex-direction:column;gap:12px;width:100%}.mapping-selects-row[data-v-2e302650]{display:flex;gap:12px;align-items:flex-end;flex-wrap:wrap}.mapping-select-item[data-v-2e302650]{flex:1;min-width:120px;display:flex;flex-direction:column;gap:4px}.mapping-label[data-v-2e302650]{font-size:12px;color:var(--muted-foreground);font-weight:500}.animation-settings[data-v-2e302650]{display:flex;flex-direction:column;gap:16px}.setting-item[data-v-2e302650]{margin-bottom:10px}.setting-item label[data-v-2e302650]{display:block;margin-bottom:6px;font-weight:500;font-size:14px;color:var(--foreground)}.setting-item input[type=text][data-v-2e302650],.setting-item select[data-v-2e302650]{width:100%;padding:8px 12px;border:1px solid rgba(0,0,0,.2);border-radius:8px;font-size:14px;background:#fff}.setting-item input[type=checkbox][data-v-2e302650]{margin-right:8px}.select-with-scroll[data-v-2e302650]{max-height:200px;overflow-y:auto}.text-mapping-section[data-v-2e302650]{margin-top:12px;padding-top:12px;border-top:1px solid rgba(0,0,0,.1)}.text-mapping-section.compact[data-v-2e302650]{margin-top:8px;padding-top:8px}.text-mapping-section h4[data-v-2e302650]{margin-bottom:8px;font-size:14px;font-weight:600}.text-mapping-section .text-mapping-header[data-v-2e302650]{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;margin-bottom:12px}.text-mapping-section .text-mapping-header h4[data-v-2e302650]{margin:0;flex-shrink:0}.text-mapping-section .text-mapping-header .hint[data-v-2e302650]{flex:1;margin:0;font-size:12px;color:var(--muted-foreground);line-height:1.4}.text-mapping-section .text-mapping-header .add-mapping-btn[data-v-2e302650]{flex-shrink:0}.mapping-list[data-v-2e302650]{display:flex;flex-direction:column;gap:8px;max-height:400px;overflow-y:auto;overflow-x:hidden;scrollbar-width:none;-ms-overflow-style:none}.mapping-list[data-v-2e302650]::-webkit-scrollbar{display:none}.mapping-item[data-v-2e302650]{padding:10px;background:rgba(0,0,0,.05);border-radius:8px}.mapping-inputs[data-v-2e302650]{display:flex;gap:8px;align-items:flex-start;flex-wrap:wrap}.text-tags-input-wrapper[data-v-2e302650]{flex:1;min-width:200px;display:flex;flex-direction:column;gap:6px}.mapping-text-input[data-v-2e302650]{width:100%;padding:8px 12px;border:1px solid rgba(0,0,0,.2);border-radius:8px;font-size:14px}.mapping-text-input.tags-input[data-v-2e302650]{padding-bottom:6px}.mapping-text-input[data-v-2e302650]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 3px rgba(99,102,241,.1)}.text-tags[data-v-2e302650]{display:flex;flex-wrap:wrap;gap:6px;margin-top:4px}.text-tag[data-v-2e302650]{display:inline-flex;align-items:center;gap:4px;padding:4px 8px;background:rgba(99,102,241,.1);color:#6366f1;border-radius:6px;font-size:12px;font-weight:500}.text-tag .tag-remove[data-v-2e302650]{display:inline-flex;align-items:center;justify-content:center;width:16px;height:16px;padding:0;margin-left:2px;border:none;background:rgba(99,102,241,.2);color:#6366f1;border-radius:50%;cursor:pointer;font-size:14px;line-height:1;transition:all .2s}.text-tag .tag-remove[data-v-2e302650]:hover{background:rgba(99,102,241,.3)}.mapping-select[data-v-2e302650]{min-width:120px;padding:8px 12px;border:1px solid rgba(0,0,0,.2);border-radius:8px;font-size:14px}.remove-mapping-btn[data-v-2e302650]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;padding:0;border:none;background:rgba(239,68,68,.1);color:#ef4444;border-radius:4px;cursor:pointer;transition:all .2s}.remove-mapping-btn[data-v-2e302650]:hover{background:rgba(239,68,68,.2)}.sprite-settings[data-v-2e302650],.background-settings[data-v-2e302650],.cg-settings[data-v-2e302650]{display:flex;flex-direction:column;gap:12px}.sprite-item[data-v-2e302650],.background-item[data-v-2e302650],.cg-item[data-v-2e302650]{padding:12px;background:rgba(0,0,0,.05);border-radius:8px}.sprite-header[data-v-2e302650],.resource-header[data-v-2e302650]{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:8px;flex-wrap:wrap}.sprite-name[data-v-2e302650],.resource-name[data-v-2e302650]{font-weight:500;color:var(--foreground);flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.add-mapping-btn-inline[data-v-2e302650]{flex-shrink:0}

:root{--foreground:#1a1a2e;--muted-foreground:#4a4a6a;--background:#fdf2f8}*{box-sizing:border-box;margin:0;padding:0}html,body{margin:0;padding:0;width:100%;height:auto;overflow-x:hidden;background:rgba(0,0,0,0)}#app{width:100%;height:auto;background:rgba(0,0,0,0);display:flex;justify-content:center;align-items:flex-start}.opening-interface-wrapper{width:100%;min-height:100vh;display:flex;justify-content:center;align-items:flex-start;background:rgba(0,0,0,0);padding:0;overflow:auto}.opening-interface{position:relative;display:flex;flex-direction:column;color:var(--foreground);font-family:"Segoe UI","Microsoft YaHei",sans-serif;background:rgba(0,0,0,0);transform-origin:top center;will-change:transform;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:100%;max-width:1200px;min-height:0;flex-shrink:1}.opening-interface.main-menu-active{width:1200px;height:800px;min-width:1200px;min-height:800px;flex-shrink:0}.background{position:absolute;inset:0;background:linear-gradient(135deg,#fce7f3 0%,#fdf2f8 50%,#f3e8ff 100%);z-index:-2}.background::before{content:"";position:absolute;inset:0;background-image:url("https://images.unsplash.com/photo-1522383225653-a7e3ad22d696?w=1920&q=80");background-size:cover;background-position:center;opacity:.4}.overlay{position:absolute;inset:0;background:linear-gradient(to bottom,rgba(253,242,248,0.3),transparent,rgba(253,242,248,0.4));z-index:-1}.particles{position:absolute;inset:0;pointer-events:none;z-index:0}.particle{position:absolute;width:8px;height:8px;background:hsla(0,0%,100%,.5);border-radius:50%;animation:float linear infinite}@keyframes float{0%,100%{transform:translateY(0) translateX(0);opacity:0}10%{opacity:.6}90%{opacity:.6}100%{transform:translateY(-100%) translateX(20px);opacity:0}}.page{position:relative;z-index:1;padding:20px;width:100%;height:100%;display:flex;flex-direction:column;flex:1;box-sizing:border-box;overflow:hidden}.upload-wizard-page{overflow:hidden}.upload-wizard-page .opening-interface{overflow:hidden}.main-menu{align-items:center;justify-content:center;text-align:center;padding-bottom:80px}.title-section{margin-bottom:80px}.title-section h1{font-size:clamp(3rem,8vw,5rem);font-weight:bold;color:var(--foreground);margin:0 0 16px 0;text-shadow:0 4px 20px hsla(0,0%,100%,.5)}.title-section .subtitle{font-size:clamp(1.2rem,3vw,1.5rem);color:var(--foreground);opacity:.8;letter-spacing:4px;margin:0}.title-section .tagline{margin-top:16px;font-size:clamp(.9rem,2vw,1.1rem);color:var(--foreground);opacity:.7;font-style:italic;margin:16px 0 0 0}.menu-buttons{display:flex;flex-direction:column;gap:20px;margin-bottom:80px}.footer{margin-top:auto;padding-top:40px;opacity:.6;font-size:14px}.bubble-btn{display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:14px 32px;background:hsla(0,0%,100%,.4);backdrop-filter:blur(12px);border:1px solid hsla(0,0%,100%,.6);border-radius:9999px;color:var(--foreground);font-size:16px;font-weight:500;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 20px hsla(0,0%,100%,.3);text-decoration:none;font-family:inherit}.bubble-btn:hover{background:hsla(0,0%,100%,.6);transform:translateY(-2px);box-shadow:0 8px 30px hsla(0,0%,100%,.4)}.bubble-btn:active{transform:translateY(0)}.bubble-btn-sm{padding:10px 20px;font-size:14px}.bubble-btn-lg{padding:16px 40px;font-size:18px;min-width:200px}.bubble-btn-round{width:50px;height:50px;padding:0;border-radius:50%}.full-width-btn{width:100%}.upload-buttons{display:flex;flex-direction:column;gap:12px;margin-top:16px}.bubble-btn-secondary{background:hsla(0,0%,100%,.6);color:var(--foreground)}.bubble-btn-secondary:hover{background:hsla(0,0%,100%,.8)}.icon{width:20px;height:20px;stroke:currentColor;stroke-width:2;fill:none}.icon-sm{width:16px;height:16px}.icon-lg{width:24px;height:24px}.start-game{width:100%;margin:0 auto;overflow-y:auto;overflow-x:hidden}.openings-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:24px;margin-bottom:24px}.opening-card{position:relative;background:hsla(0,0%,100%,.3);backdrop-filter:blur(12px);border:1px solid hsla(0,0%,100%,.5);border-radius:20px;overflow:hidden;cursor:pointer;transition:all .3s ease}.opening-card:hover{background:hsla(0,0%,100%,.5);transform:scale(1.02);box-shadow:0 10px 40px hsla(0,0%,100%,.3)}.opening-card .image-wrapper{position:relative;width:100%;aspect-ratio:16/9;overflow:hidden}.opening-card .image-wrapper::after{content:"";position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,0.4),transparent)}.opening-card img{width:100%;height:100%;object-fit:cover;transition:transform .5s ease}.opening-card:hover img{transform:scale(1.1)}.opening-card img{width:100%;height:100%;object-fit:cover}.opening-card .content{padding:16px;text-align:left}.opening-card h3{font-size:1.25rem;font-weight:bold;color:var(--foreground);margin-bottom:8px;margin:0 0 8px 0}.opening-card p{font-size:.875rem;color:var(--muted-foreground);margin:0}.opening-card .hover-icon{position:absolute;top:16px;right:16px;width:32px;height:32px;background:hsla(0,0%,100%,.5);backdrop-filter:blur(8px);border-radius:50%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .3s ease}.opening-card:hover .hover-icon{opacity:1}.hint-text{text-align:center;color:var(--foreground);opacity:.7;font-size:14px;margin-top:24px}.settings{width:100%;max-width:800px;margin:0 auto;overflow-y:auto;overflow-x:hidden}.settings-content{display:flex;flex-direction:column;gap:24px}.settings-card{background:hsla(0,0%,100%,.3);backdrop-filter:blur(12px);border:1px solid hsla(0,0%,100%,.5);border-radius:20px;padding:24px}.settings-card-header{display:flex;align-items:flex-start;gap:16px;margin-bottom:16px}.settings-card-icon{width:40px;height:40px;background:hsla(0,0%,100%,.5);border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}.settings-card-header h3{margin:0 0 4px 0;font-size:18px;font-weight:600;color:var(--foreground)}.settings-card-header .desc{font-size:.875rem;color:var(--muted-foreground);margin:0;line-height:1.5}.url-input-group{display:flex;gap:12px}.url-input-group input{flex:1;padding:12px 20px;background:hsla(0,0%,100%,.5);border:1px solid hsla(0,0%,100%,.5);border-radius:9999px;color:var(--foreground);font-size:14px;outline:none;font-family:inherit}.url-input-group input:focus{box-shadow:0 0 0 2px hsla(0,0%,100%,.5)}.url-input-group input::placeholder{color:var(--muted-foreground)}.hidden-input{display:none}.config-list{display:flex;flex-direction:column;gap:12px}.config-item{display:flex;align-items:center;justify-content:space-between;background:hsla(0,0%,100%,.4);border-radius:12px;padding:12px 16px}.config-item-left{display:flex;align-items:center;gap:12px}.config-item-name{font-size:.875rem;color:var(--foreground);max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.config-item-right{display:flex;align-items:center;gap:12px}.check-icon{color:#16a34a}.remove-btn{width:24px;height:24px;background:hsla(0,0%,100%,.5);border:none;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:background .2s ease;padding:0}.remove-btn:hover{background:hsla(0,0%,100%,.7)}.character-intro{width:100%;max-width:1200px;margin:0 auto;overflow-y:auto;overflow-x:hidden;padding:0 10px;box-sizing:border-box}.character-display{display:flex;align-items:center;justify-content:space-between;gap:24px;margin-bottom:24px;width:100%;position:relative;padding:0 10px;box-sizing:border-box}.nav-btn{flex-shrink:0;position:relative;z-index:10}.character-display .character-card{flex:1;max-width:calc(100% - 148px);min-width:0}.character-card{flex:1;background:linear-gradient(135deg,rgba(251,207,232,0.5),rgba(244,114,182,0.3));backdrop-filter:blur(12px);border:1px solid hsla(0,0%,100%,.5);border-radius:24px;overflow:hidden;box-shadow:0 10px 40px hsla(0,0%,100%,.2);transition:all .5s ease}.character-card.blue{background:linear-gradient(135deg,rgba(191,219,254,0.5),rgba(99,102,241,0.3))}.character-card.orange{background:linear-gradient(135deg,rgba(254,215,170,0.5),rgba(251,146,60,0.3))}.character-card.gray{background:linear-gradient(135deg,rgba(226,232,240,0.5),rgba(148,163,184,0.3))}.character-card-inner{display:flex;flex-direction:column}@media (min-width:768px){.character-card-inner{flex-direction:row}}.character-image{position:relative;flex:1;min-height:300px}.character-image img{width:100%;height:100%;object-fit:cover;min-height:300px}.character-image::after{content:"";position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,0.3),transparent)}@media (min-width:768px){.character-image::after{background:linear-gradient(to right,transparent,rgba(0,0,0,0.2))}}.character-info{flex:1;padding:24px;display:flex;flex-direction:column;justify-content:center}.character-role{display:inline-block;align-self:flex-start;padding:6px 12px;background:hsla(0,0%,100%,.5);border-radius:9999px;font-size:.75rem;font-weight:500;color:var(--foreground);margin-bottom:12px}.character-name{font-size:clamp(1.8rem,5vw,2.5rem);font-weight:bold;color:var(--foreground);margin-bottom:16px;margin:0 0 16px 0}.character-desc{color:var(--muted-foreground);line-height:1.7;margin:0}.character-dots{display:flex;align-items:center;gap:8px;margin-top:32px}.character-dots .dot{width:8px;height:8px;border-radius:9999px;background:rgba(26,26,46,.3);border:none;cursor:pointer;transition:all .3s ease;padding:0}.character-dots .dot:hover{background:rgba(26,26,46,.5)}.character-dots .dot.active{width:24px;background:var(--foreground)}.page-header{width:100%;max-width:1000px;display:flex;align-items:center;justify-content:space-between;padding:20px;margin-bottom:20px;position:relative}.page-header h2{font-size:clamp(1.5rem,4vw,2rem);font-weight:bold;color:var(--foreground);display:flex;align-items:center;gap:10px;margin:0;position:absolute;left:50%;transform:translateX(-50%);white-space:nowrap}.page-header-actions{min-width:80px;display:flex;align-items:center;justify-content:flex-end;gap:8px}.spacer{width:80px;flex-shrink:0}@media (max-width:768px){.opening-interface{padding:10px}.title-section h1{font-size:clamp(2rem,6vw,3rem)}.title-section .subtitle{font-size:clamp(1rem,3vw,1.2rem)}.bubble-btn-lg{padding:12px 24px;font-size:16px;min-width:160px}.openings-grid{grid-template-columns:repeat(2,1fr);gap:16px}.character-display{flex-direction:column;gap:16px}.nav-btn{order:2}.character-card{order:1;width:100%}.page-header{padding:12px}.page-header h2{font-size:clamp(1.2rem,4vw,1.5rem)}.settings-card{padding:16px}}@media (max-width:480px){.opening-interface{padding:8px}.menu-buttons{gap:12px}.bubble-btn{padding:10px 20px;font-size:14px}.settings-card-header{flex-direction:column;align-items:flex-start;gap:8px}}

/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body>